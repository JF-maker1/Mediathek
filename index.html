<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello World - Z√°kladn√≠ Aplikace</title>
    <style>
        body {
            font-family: sans-serif; 
            display: flex;
            flex-direction: column; 
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f4; 
            color: #333;
        }
        h1 {
            color: #007bff;
        }
        
        /* Nov√© styly pro video a ovl√°d√°n√≠ */
        #video-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px; 
            margin-top: 20px;
        }
        
        /* Styl pro tlaƒç√≠tka */
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #28a745;
            color: white;
            transition: background-color 0.3s;
        }

        #pause-button {
            background-color: #dc3545;
        }
        
        button:hover {
            opacity: 0.8;
        }

        /* NOV√â STYLY PRO PLAYLIST */
        #playlist-box {
            margin-top: 30px;
            width: 640px; /* Stejn√° ≈°√≠≈ôka jako video */
            border: 1px solid #ccc;
            padding: 15px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .playlist-item {
            padding: 8px 10px;
            margin-bottom: 5px;
            background-color: #e9ecef;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s, box-shadow 0.2s;
        }

        .playlist-item:hover {
            background-color: #dee2e6;
        }

        .selected {
            background-color: #007bff;
            color: white;
            font-weight: bold;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }
    </style>
</head>
<body>
    <h1>Hello World! üëã</h1>
    <p>Toto je poƒç√°teƒçn√≠ verze webov√© aplikace.</p>

    <div id="video-container">
        
        <button onclick="playVideo()">P≈ôehr√°t video</button>
        
        <div id="player"></div>
        
        <button id="pause-button" onclick="pauseVideo()">‚è∏Ô∏è Pauza</button>
        
    </div>
    
    <div id="playlist-box">
        <h2>Seznam vide√≠</h2>
    </div>

    <script>
      // 1. Zaveden√≠ YouTube IFrame Player API scriptu 
      var tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
      
      // 2. Deklarace promƒõnn√© pro YouTube p≈ôehr√°vaƒç
      var player;
      // ZMƒöNA: Seznam vide√≠ a promƒõnn√° pro aktu√°ln√≠ vybran√© ID
      // Ponech√°me pouze ID, n√°zev bude naƒçten dynamicky z API.
      const playlist = [
        { id: 'pxPI_fsJTAU', title: 'Naƒç√≠t√°m...' }, 
        { id: 'ue3R5dBynWQ', title: 'Naƒç√≠t√°m...' }
      ];
      let currentVideoId = playlist[0].id; // Nastaven√≠ prvn√≠ho videa jako v√Ωchoz√≠ho

      // NOV√Å: Asynchronn√≠ funkce pro naƒçten√≠ n√°zv≈Ø z Vercel Proxy (/api/get-titles)
      async function fetchVideoTitles() {
        const videoIds = playlist.map(v => v.id); // Z√≠sk√°me pole ID
        console.log('Fetching titles for IDs:', videoIds);

        try {
            // Vol√°n√≠ Serverless Proxy, kter√© bezpeƒçnƒõ zavol√° YouTube API
            const response = await fetch('/api/get-titles', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ videoIds })
            });

            const data = await response.json();

            if (!response.ok) {
                console.error('Failed to fetch titles from proxy:', data.error);
                // P≈ôi chybƒõ nech√°me doƒçasn√© n√°zvy ('Naƒç√≠t√°m...')
                return;
            }

            // Aktualizace glob√°ln√≠ho playlistu s dynamick√Ωmi n√°zvy
            data.titles.forEach(apiVideo => {
                const index = playlist.findIndex(v => v.id === apiVideo.id);
                if (index !== -1) {
                    playlist[index].title = apiVideo.title;
                }
            });
            
            renderPlaylist(); // Vykreslen√≠ playlistu s dynamick√Ωmi n√°zvy

        } catch (error) {
            console.error('Network or parsing error during title fetch:', error);
        }
      }
      
      // Funkce pro vykreslen√≠ playlistu do DOM (P≈Øvodn√≠ logika z≈Øst√°v√°)
      function renderPlaylist() {
        const playlistBox = document.getElementById('playlist-box');
        let html = '';
        
        playlist.forEach(video => {
          // Nastaven√≠ t≈ô√≠dy 'selected' pro aktu√°lnƒõ vybran√© video
          const isSelected = video.id === currentVideoId ? ' selected' : '';
          html += `<div class="playlist-item${isSelected}" 
                        onclick="selectVideo('${video.id}')">
                    ${video.title}
                  </div>`;
        });
        playlistBox.innerHTML = `<h2>Seznam vide√≠</h2>${html}`;
      }
      
      // Funkce pro v√Ωbƒõr videa z playlistu (P≈Øvodn√≠ logika z≈Øst√°v√°)
      function selectVideo(videoId) {
        currentVideoId = videoId;
        renderPlaylist(); // P≈ôekresl√≠ playlist pro aktualizaci zv√Ωraznƒõn√≠
      }

      // ZMƒöNA: Spu≈°tƒõn√≠ naƒç√≠t√°n√≠ dat a vykreslen√≠ playlistu p≈ôi naƒçten√≠ str√°nky
      document.addEventListener('DOMContentLoaded', fetchVideoTitles); 
      
      // 3. Funkce volan√° po naƒçten√≠ API 
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '390',
          width: '640',
          // ZMƒöNA: videoId se nastavuje z promƒõnn√© currentVideoId (v√Ωchoz√≠ video)
          videoId: currentVideoId, 
          playerVars: {
            'controls': 1, // Zobrazit ovl√°dac√≠ prvky
            'autoplay': 0, // Nezaƒç√≠nat automaticky
            'modestbranding': 1 // Skromnƒõj≈°√≠ branding
          },
          events: {
            // 'onReady': onPlayerReady, // V p≈ô√≠padƒõ pot≈ôeby akce po naƒçten√≠ 
          }
        });
      }

      // 4. Funkce pro ovl√°d√°n√≠ p≈ôehr√°v√°n√≠ z tlaƒç√≠tka
      function playVideo() {
        // ZMƒöNA: Pou≈æ√≠v√° loadVideoById pro naƒçten√≠ a spu≈°tƒõn√≠ vybran√©ho videa
        if (player && typeof player.loadVideoById === 'function') {
          player.loadVideoById(currentVideoId);
        }
      }

      // 5. Funkce pro ovl√°d√°n√≠ pauzy z tlaƒç√≠tka
      function pauseVideo() {
        if (player && typeof player.pauseVideo === 'function') {
          player.pauseVideo();
        }
      }
    </script>
</body>
</html>
