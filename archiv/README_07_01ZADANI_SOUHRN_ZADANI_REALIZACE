J√Å_PROMPT:
V p≈ô√≠loze jsou v√Ωsledky z p≈ôede≈°l√Ωch f√°z√≠ 0 a≈æ 6 v√Ωvoje webov√© aplikace zamƒõ≈ôen√© na spr√°vu a strukturalizaci obsahu vide√≠. P≈ôilo≈æen√© dokumenty maj√≠ mezi sebou takovou strukturu, ≈æe jeden dokument z jednoho kroku v√Ωvoje [soubor README_XX_01ZADANI] je diskuze na zad√°n√≠m dan√©ho kroku v√Ωvoje t√©to webov√© aplikace resp. v√Ωvoj m√° za sebou 7 krok≈Ø v√Ωvoje [soubory 00 a≈æ 06]. Pros√≠m o projit√≠ tƒõchto dokument≈Ø a vytvo≈ôen√≠ souhrnn√© zpr√°vy o dosavadn√≠m v√Ωvoji t√©to aplikace. V tƒõchto jednotliv√Ωch zpr√°v√°ch jsou i pozn√°mky o mo≈æn√©m dal≈°√≠m v√Ωvoji t√©to aplikace co≈æ jsou pomysln√© vƒõtve tohoto kmene v√Ωvoje, kter√© dosud nebyly realizov√°ny a jsou zat√≠m jenom zva≈æov√°ny k realizaci. Pros√≠m aby zpr√°va o doasavadn√≠m v√Ωvoji t√©to aplikace naznaƒçila tento strom v√Ωvoje jeho≈æ kmenem je to co bylo ji≈æ realizov√°no a vƒõtve jsou mo≈æn√© v√Ωhonky jeho dal≈°√≠ho smƒõ≈ôov√°n√≠ resp. ony dosud nerezilovan√© ƒç√°sti zm√≠nƒõn√© v diskuz√≠ch o dal≈°√≠m v√Ωvoji aplikace v tƒõchto dokumentech. Tak√© jsou zde samoz≈ôejmƒõ kompletn√≠ zad√°n√≠ toho co realizov√°no v dan√©m kroku bylo. p≈ô√≠lohy:[README_00_01ZADANI][README_01_01ZADANI][README_02_01ZADANI][README_03_01ZADANI][README_04_01ZADANI][README_05_01ZADANI][README_06_01ZADANI]

AI_RESPONZE:

Jistƒõ, zde je souhrnn√° zpr√°va o dosavadn√≠m v√Ωvoji va≈°√≠ aplikace "Mediathek" na z√°kladƒõ sedmi poskytnut√Ωch dokument≈Ø (f√°ze 0 a≈æ 6).

Zpr√°va je strukturov√°na p≈ôesnƒõ podle va≈°√≠ metafory "stromu v√Ωvoje". Popisuje "kmen" jako hlavn√≠ linii zadan√©ho a realizovan√©ho v√Ωvoje a "vƒõtve" jako n√°pady a pl√°ny zm√≠nƒõn√© v diskuz√≠ch, kter√© dosud nebyly implementov√°ny, ale p≈ôedstavuj√≠ budouc√≠ smƒõ≈ôov√°n√≠ projektu.

---

### üå≥ Souhrnn√° Zpr√°va o V√Ωvoji Aplikace Mediathek (F√°ze 0-6)

[cite_start]Aplikace Mediathek je vyv√≠jena s viz√≠ vytvo≈ôit platformu pro kur√°torstv√≠ video obsahu[cite: 409, 681]. [cite_start]C√≠lem je, aby "galerist√©" (nejprve administr√°tor, pozdƒõji i u≈æivatel√©) [cite: 684, 964] [cite_start]mohli vytv√°≈ôet sb√≠rky vide√≠ a obohacovat je o strukturovan√Ω obsah (podobn√Ω obsahu knihy s ƒçasov√Ωmi znaƒçkami)[cite: 689, 913, 957]. [cite_start]T√≠m aplikace poskytne n√°v≈°tƒõvn√≠k≈Øm kontext a snadnou orientaci, kterou bƒõ≈æn√© platformy jako YouTube nenab√≠zej√≠[cite: 561, 619]. [cite_start]Koneƒçnou viz√≠ je "televizn√≠ spoleƒçnost tvo≈ôen√° kur√°torstv√≠m jejich u≈æivatel≈Ø"[cite: 54, 463, 625].

---

### Kmen: Realizovan√° Cesta V√Ωvoje (Zad√°n√≠ F√°z√≠ 0-6)

Hlavn√≠ kmen p≈ôedstavuje dosud zadan√© a realizovan√© kroky, kter√© budovaly funkƒçnost postupnƒõ, se zamƒõ≈ôen√≠m na roli Administr√°tora jako prvn√≠ho kur√°tora obsahu.

#### üå± F√°ze 0: Zalo≈æen√≠ a "Kick-off"
* [cite_start]**C√≠l:** Poƒç√°teƒçn√≠ "v√Ωkop" projektu[cite: 520].
* [cite_start]**Zad√°no:** Vytvo≈ôen√≠ z√°kladn√≠ jednostr√°nkov√© statick√© aplikace [cite: 531] [cite_start]s n√°zvem "Mediathek: Tv√° sb√≠rka Tv√Ωch vide√≠"[cite: 532]. [cite_start]Hlavn√≠m √∫kolem bylo ovƒõ≈ôen√≠ cel√©ho technologick√©ho ≈ôetƒõzce: lok√°ln√≠ v√Ωvoj (na Raspberry Pi) [cite: 543] [cite_start]a automatick√© nasazen√≠ na platformu Vercel[cite: 544, 545].

#### üå≤ F√°ze 1 (Zad√°n√≠ pro F√°zi 2): Ko≈ôeny ‚Äì Autentizace a Datab√°ze
* [cite_start]**C√≠l:** Vytvo≈ôit z√°klad pro personalizovanou aplikaci[cite: 44].
* [cite_start]**Zad√°no:** Implementace kompletn√≠ho syst√©mu pro spr√°vu u≈æivatel≈Ø (registrace/p≈ôihl√°≈°en√≠) [cite: 43, 47][cite_start], vƒçetnƒõ v√Ωbƒõru a nastaven√≠ datab√°ze (nap≈ô. Vercel Postgres) [cite: 46] [cite_start]a vytvo≈ôen√≠ datab√°zov√©ho sch√©matu pro u≈æivatele (`User`)[cite: 46]. [cite_start]Byly definov√°ny z√°kladn√≠ role (ADMIN a USER) [cite: 79] [cite_start]a zabezpeƒçen√≠ str√°nek pro p≈ôihl√°≈°en√© u≈æivatele[cite: 47].

#### üå≤ F√°ze 2 (Zad√°n√≠ pro F√°zi 3): Admin "Create"
* [cite_start]**C√≠l:** D√°t roli ADMIN prvn√≠ skuteƒçnou funkci a zaƒç√≠t plnit datab√°zi obsahem[cite: 418, 422].
* [cite_start]**Zad√°no:** Vytvo≈ôen√≠ nov√©ho datab√°zov√©ho modelu `Video` propojen√©ho s u≈æivatelem (autorem)[cite: 479, 480]. [cite_start]D√°le vytvo≈ôen√≠ zabezpeƒçen√© administr√°torsk√© str√°nky (formul√°≈ôe) [cite: 475][cite_start], kde m≈Ø≈æe admin (prvn√≠ kur√°tor) [cite: 463] [cite_start]manu√°lnƒõ vlo≈æit URL videa, vlastn√≠ n√°zev a vlastn√≠ struƒçn√© shrnut√≠[cite: 449, 465, 489].

#### üå≤ F√°ze 3 (Zad√°n√≠ pro F√°zi 4): Admin "Read"
* [cite_start]**C√≠l:** Umo≈ænit administr√°torovi vidƒõt a kontrolovat obsah, kter√Ω vlo≈æil[cite: 917, 922].
* [cite_start]**Zad√°no:** Vytvo≈ôen√≠ nov√©, zabezpeƒçen√© str√°nky "Admin Dashboard" (nap≈ô. `/admin/dashboard`)[cite: 950]. [cite_start]Tato str√°nka byla navr≈æena jako React Server Component (RSC) pro bezpeƒçn√© naƒçten√≠ dat[cite: 979, 981]. [cite_start]Zobrazuje seznam (formou m≈ô√≠≈æky nebo tabulky) [cite: 951, 984] [cite_start]v≈°ech vide√≠ p≈ôidan√Ωch administr√°torem, vƒçetnƒõ jejich n√°zvu a shrnut√≠[cite: 952].

#### üå≤ F√°ze 4 (Zad√°n√≠ pro F√°zi 5): Admin "Consume"
* [cite_start]**C√≠l:** Uzav≈ô√≠t z√°kladn√≠ administr√°torsk√Ω cyklus (Create -> Read -> Consume)[cite: 613, 637].
* [cite_start]**Zad√°no:** Vytvo≈ôen√≠ dynamick√© str√°nky detailu videa (nap≈ô. `/admin/video/[id]`)[cite: 608, 640]. [cite_start]Polo≈æky na Admin Dashboardu (z F√°ze 3) se staly klikateln√Ωmi odkazy na tuto novou str√°nku[cite: 609, 641]. [cite_start]Zde byl integrov√°n YouTube p≈ôehr√°vaƒç (pomoc√≠ `react-youtube`) [cite: 643] [cite_start]a zobrazen pln√Ω n√°zev a shrnut√≠ videa[cite: 610]. [cite_start]Tato str√°nka byla navr≈æena jako "kontejner" pro budouc√≠ strukturovan√Ω obsah[cite: 615, 639].

#### üå≥ F√°ze 5 (Zad√°n√≠ pro F√°zi 6): J√°dro Hodnoty ‚Äì Strukturovan√Ω Obsah
* [cite_start]**C√≠l:** Implementovat kl√≠ƒçovou a unik√°tn√≠ funkci aplikace ‚Äì "obsah knihy" pro videa[cite: 688, 806, 807].
* [cite_start]**Zad√°no:** Po rozs√°hl√© diskuzi [cite: 730-738] [cite_start]byla schv√°lena "Varianta C" [cite: 791] [cite_start]s u≈æivatelsk√Ωm vylep≈°en√≠m[cite: 795, 800]:
    1.  [cite_start]**Vstup:** P≈ôid√°n√≠ jednoduch√©ho textov√©ho pole (`<textarea>`) do admin formul√°≈ôe `/admin/add`[cite: 809, 857].
    2.  [cite_start]**Form√°t (MTF-H):** Byl definov√°n robustn√≠ form√°t, kde hierarchii urƒçuje ƒç√≠slov√°n√≠ (nap≈ô. `1.1.1.`) [cite: 815, 816, 866] [cite_start]a ≈ô√°dek konƒç√≠ ƒçasovou znaƒçkou (nap≈ô. `(0:00 - 0:19)`)[cite: 817, 867].
    3.  [cite_start]**Backend:** Vytvo≈ôen√≠ nov√©ho datab√°zov√©ho modelu `Chapter` [cite: 808, 873] [cite_start]a parseru, kter√Ω tento text zpracuje, extrahuje `level` (z ƒç√≠slov√°n√≠), `startTime` a `text` a ulo≈æ√≠ je do datab√°ze[cite: 810, 879, 883].
    4.  [cite_start]**Frontend:** Zobrazen√≠ tohoto obsahu na str√°nce detailu videa (z F√°ze 4) s vizu√°ln√≠m odsazen√≠m podle √∫rovnƒõ (`level`)[cite: 811, 859, 890].
    5.  [cite_start]**Interaktivita:** Propojen√≠ seznamu kapitol s p≈ôehr√°vaƒçem ‚Äì kliknut√≠ na kapitolu posune video na dan√Ω ƒças (`seekTo`)[cite: 812, 860, 891].

#### üå≤ F√°ze 6 (Zad√°n√≠ pro F√°zi 7): Pln√° Spr√°va (Admin "CRUD")
* [cite_start]**C√≠l:** Implementovat chybƒõj√≠c√≠ operace Update (U) a Delete (D) a zalo≈æit robustn√≠ z√°klady pro budouc√≠ role[cite: 355].
* [cite_start]**Zad√°no:** Po diskuzi [cite: 299-308] [cite_start]byla zvolena "Varianta B" pro jej√≠ ≈°k√°lovatelnost[cite: 337, 341]:
    1.  [cite_start]**Architektura:** Vytvo≈ôen√≠ nov√© strategick√© str√°nky `/admin/manage` (m√≠sto √∫pravy dashboardu) [cite: 358][cite_start], kter√° zobrazuje videa v p≈ôehledn√© tabulce (`<table>`)[cite: 323].
    2.  [cite_start]**Funkce:** Vytvo≈ôen√≠ nov√© dynamick√© str√°nky `/admin/edit/[id]` s p≈ôedvyplnƒõn√Ωm formul√°≈ôem[cite: 359, 378].
    3.  [cite_start]**API:** Vytvo≈ôen√≠ nov√Ωch API endpoint≈Ø (`PUT`, `DELETE`, `GET [id]`) na trase `/api/videos/[id]`[cite: 360, 383].
    4.  [cite_start]**Opr√°vnƒõn√≠ (RBAC):** Implementace kl√≠ƒçov√© server-side logiky, kter√° ovƒõ≈ôuje, zda je u≈æivatel admin (`isAdmin`) NEBO vlastn√≠k obsahu (`isOwner`)[cite: 361, 372]. [cite_start]T√≠m je syst√©m p≈ôipraven na budouc√≠ roli "KURATOR"[cite: 373].

---

### Vƒõtve: Pl√°novan√Ω Budouc√≠ Rozvoj

Tyto "vƒõtve" p≈ôedstavuj√≠ n√°pady a pl√°ny zm√≠nƒõn√© v diskuz√≠ch o zad√°n√≠, kter√© dosud nebyly prioritizov√°ny pro implementaci, ale tvo≈ô√≠ mapu budouc√≠ho smƒõ≈ôov√°n√≠ projektu.

#### üåø Vƒõtev 1: Zp≈ô√≠stupnƒõn√≠ Ve≈ôejnosti (Nejvƒõt≈°√≠ vƒõtev)
* [cite_start]**Popis:** Toto je nejƒçastƒõji zmi≈àovan√Ω a nejlogiƒçtƒõj≈°√≠ dal≈°√≠ krok, kter√Ω byl pl√°nov√°n t√©mƒõ≈ô v ka≈æd√© f√°zi [cite: 424, 586, 908, 931][cite_start], ale v F√°zi 6 byl vƒõdomƒõ p≈ôeskoƒçen [cite: 291] ve prospƒõch dobudov√°n√≠ admin rozhran√≠.
* [cite_start]**Pl√°n:** Vytvo≈ôit ve≈ôejnou, nespravovanou "v√Ωkladn√≠ sk≈ô√≠≈à" (nap≈ô. na domovsk√© str√°nce `/`) [cite: 265] [cite_start]a ve≈ôejnou verzi str√°nky detailu videa (nap≈ô. `/video/[id]`)[cite: 267], aby mohl obsah konzumovat kdokoli.

#### üåø Vƒõtev 2: Otev≈ôen√≠ U≈æivatel≈Øm (U≈æivatel√© jako Kur√°to≈ôi)
* [cite_start]**Popis:** Toto je druh√Ω pil√≠≈ô hlavn√≠ vize ‚Äì "postupnƒõ se kur√°torstv√≠ roz≈°√≠≈ô√≠ i na u≈æivatele"[cite: 55, 464, 626].
* [cite_start]**Pl√°n:** Umo≈ænit p≈ôihl√°≈°en√Ωm u≈æivatel≈Øm (roli `USER`) vytv√°≈ôet si vlastn√≠, osobn√≠ knihovny vide√≠[cite: 440, 602, 945]. To by zahrnovalo buƒè ukl√°d√°n√≠ vide√≠ z hlavn√≠ galerie, nebo (jako vƒõt≈°√≠ krok) umo≈ænƒõn√≠ jim p≈ôid√°vat a strukturovat vlastn√≠ videa, stejnƒõ jako to nyn√≠ dƒõl√° admin.
* [cite_start]**Stav:** Technologicky je tento krok z velk√© ƒç√°sti p≈ôipraven d√≠ky RBAC logice (`isOwner`) implementovan√© v F√°zi 6[cite: 361, 372].

#### üåø Vƒõtev 3: Kompilovan√Ω Obsah a Vyhled√°v√°n√≠
* [cite_start]**Popis:** Dlouhodob√° vize "ultim√°tn√≠" p≈ôidan√© hodnoty[cite: 252, 621].
* [cite_start]**Pl√°n:** Vytv√°≈ôen√≠ "ƒçl√°nk≈Ø" nebo "knih", kter√© kompiluj√≠ strukturovan√Ω obsah z v√≠ce vide√≠ do jednoho souhrnn√©ho celku[cite: 460, 461, 622]. [cite_start]S t√≠m souvis√≠ i my≈°lenka pokroƒçil√©ho vyhled√°v√°n√≠, kter√© by nehledalo jen n√°zvy vide√≠, ale prohled√°valo texty v modelu `Chapter` nap≈ô√≠ƒç celou datab√°z√≠[cite: 284].

#### üåø Vƒõtev 4: Pokroƒçil√© Role a Koncepty
* **Popis:** Specifick√© n√°pady, kter√© se objevily bƒõhem pl√°nov√°n√≠ F√°ze 6.
* **Pl√°n:**
    * [cite_start]**Sb√≠rky (Collections):** My≈°lenka, ≈æe videa by mohla b√Ωt organizov√°na do t√©matick√Ωch "sb√≠rek" (jako playlisty), kter√© by spravoval kur√°tor[cite: 304].
    * [cite_start]**Nov√© Role:** Specifick√© role nad r√°mec ADMIN/USER, jako **KURATOR** (spr√°vce sb√≠rek) [cite: 342] [cite_start]nebo **PRUVODCE** (role, kter√° m≈Ø≈æe vytv√°≈ôet "cesty" nebo "prohl√≠dky" sb√≠rkami)[cite: 343].
    * [cite_start]**Sledov√°n√≠ Pokroku:** Mo≈ænost pro u≈æivatele sledovat, co ji≈æ ve vide√≠ch vidƒõli[cite: 458, 620].
    * [cite_start]**Automatizace:** Brzy zm√≠nƒõn√° my≈°lenka na automatick√© generov√°n√≠ p≈ôepis≈Ø nebo shrnut√≠ (nap≈ô. pomoc√≠ AI) [cite: 29][cite_start], aƒçkoli souƒçasn√Ω v√Ωvoj se soust≈ôedil na manu√°ln√≠ kur√°torstv√≠[cite: 466].
    
    
    
    
    
    
    
    

J√Å_PROMPT:
Podobnou zpr√°vu o dosavadn√≠m technologick√©m v√Ωvoji aplikace pros√≠m vytvo≈ôit nyn√≠ i z dokument≈Ø popisuj√≠c√≠ konkr√©tn√≠ realizaci t√©to webov√© aplikace. Tato zpr√°va by mƒõla obsahovat zpr√°vu o technologick√© konstrukci t√©to aplikace resp. o dosavadn√≠m technologick√©m v√Ωvoji t√©to aplikace vƒçetnƒõ zde zm√≠nƒõn√Ωch tip≈Ø pro jej√≠ dal≈°√≠ technologick√Ω v√Ωvoj, co≈æ odr√°≈æ√≠ i technologick√© mo≈ænosti t√©to aplikace o jej√≠m dal≈°√≠m mo≈æn√©m v√Ωvoji. P≈ôilo≈æen√© dokumenty maj√≠ mezi sebou takovou strukturu, ≈æe jeden dokument z jednoho kroku v√Ωvoje [soubor README_XX_02REALIZACE] je diskuze nad samotnou realizac√≠ t√©to webov√© aplikace vych√°zej√≠c√≠ho z p≈ô√≠slu≈°n√©ho zad√°n√≠ v tomto kroku v√Ωvoje resp. v√Ωvoj m√° za sebou 7 krok≈Ø v√Ωvoje resp. v√Ωvoje zad√°n√≠ a v√Ωvoje samotn√© realizace resp architektury t√©to aplikace [soubory 00 a≈æ 06]. P≈ô√≠loha: [README_00_02REALIZACE_Kick-off][README_01_02REALIZACE][README_02_02REALIZACE][README_03_02REALIZACE][README_04_02REALIZACE][README_05_02REALIZACE][README_06_02REALIZACE]

AI_RESPONZE:

Jistƒõ, zde je souhrnn√° zpr√°va o dosavadn√≠m technologick√©m v√Ωvoji aplikace Mediathek, sestaven√° v√Ωhradnƒõ z p≈ôilo≈æen√Ωch dokument≈Ø o realizaci (`README_XX_02REALIZACE`).

Tato zpr√°va mapuje, jak byla aplikace technologicky konstruov√°na, jak√© kl√≠ƒçov√© probl√©my byly ≈ôe≈°eny a jak√° technologick√° vylep≈°en√≠ byla navr≈æena pro budouc√≠ v√Ωvoj.

---

### üõ†Ô∏è Souhrnn√° Zpr√°va o Technologick√©m V√Ωvoji Aplikace Mediathek (F√°ze 0-6)

Technologick√Ω v√Ωvoj aplikace Mediathek p≈ôedstavuje postupn√Ω proces od z√°kladn√≠ho nastaven√≠ modern√≠ho webov√©ho stacku a≈æ po implementaci robustn√≠, na data napojen√© a bezpeƒçn√© redakƒçn√≠ platformy. Kl√≠ƒçov√Ωm prvkem cel√©ho v√Ωvoje bylo ≈ôe≈°en√≠ a ladƒõn√≠ integrace mezi jednotliv√Ωmi technologiemi (Next.js, Prisma, Vercel, NextAuth.js), co≈æ vytvo≈ôilo solidn√≠ z√°klad pro budouc√≠ funkce.

### Kmen: Realizovan√° Technologick√° Konstrukce

Zde je pops√°n postupn√Ω v√Ωvoj hlavn√≠ technologick√© "kostry" aplikace, jak byl implementov√°n v jednotliv√Ωch f√°z√≠ch.

#### üå± F√°ze 0: Zalo≈æen√≠ Projektu a Konfigurace Prost≈ôed√≠
* [cite_start]**Technologick√Ω Stack:** Projekt byl inicializov√°n pomoc√≠ `npx create-next-app`[cite: 1273]. [cite_start]Byl zvolen z√°kladn√≠ stack: **Next.js 14+** (s App Router), **TypeScript** a **Tailwind CSS**[cite: 1273, 1274, 1275].
* [cite_start]**V√Ωvojov√© Prost≈ôed√≠:** V√Ωvoj prob√≠h√° na **Raspberry Pi 5** (Debian)[cite: 1262].
* [cite_start]**Deployment:** C√≠lov√° platforma byla od zaƒç√°tku nastavena na **Vercel**[cite: 1293].
* **Kl√≠ƒçov√Ω Probl√©m (Git):** Prvn√≠ technologickou v√Ωzvou bylo nastaven√≠ verzov√°n√≠. [cite_start]Autentizace p≈ôes `HTTPS` a heslo selhala (funkce je zastaral√°)[cite: 1327].
* [cite_start]**≈òe≈°en√≠ (Git):** Byl implementov√°n p≈ôechod na autentizaci pomoc√≠ **SSH kl√≠ƒç≈Ø (Ed25519)**[cite: 1329]. [cite_start]To vy≈æadovalo zmƒõnu `git remote set-url origin` z HTTPS na SSH form√°t [cite: 1331] [cite_start]a vy≈ôe≈°en√≠ prvotn√≠ho `git push --set-upstream origin main`[cite: 1334].

---

#### üå≤ F√°ze 1: Implementace Backendu (Autentizace a Datab√°ze)
* **Technologick√Ω Stack (Roz≈°√≠≈ôen√≠):** Do projektu byly integrov√°ny kl√≠ƒçov√© backendov√© technologie:
    * [cite_start]**Datab√°ze:** **Vercel Postgres**[cite: 1526].
    * [cite_start]**ORM:** **Prisma** pro spr√°vu sch√©matu a dotazov√°n√≠[cite: 1523].
    * [cite_start]**Autentizace:** **NextAuth.js** s vyu≈æit√≠m `CredentialsProvider` (p≈ôihl√°≈°en√≠ e-mailem a heslem)[cite: 1537].
    * [cite_start]**Zabezpeƒçen√≠:** **bcrypt** pro hashov√°n√≠ hesel[cite: 1523].
* [cite_start]**Sch√©ma:** Bylo inicializov√°no `prisma/schema.prisma` a definov√°n model `User` (s `email`, `password`, `role`)[cite: 1532].
* **Kl√≠ƒçov√© Probl√©my a ≈òe≈°en√≠ (Integrace):** Tato f√°ze byla technologicky nejn√°roƒçnƒõj≈°√≠ kv≈Øli probl√©m≈Øm s integrac√≠ Prisma a Vercel.
    * [cite_start]**Chyba Prisma CLI:** `prisma migrate dev` selh√°valo, proto≈æe n√°stroje Prisma automaticky neƒçtou `.env.local`[cite: 1601].
    * [cite_start]**≈òe≈°en√≠:** Byla p≈ôid√°na knihovna `dotenv-cli` [cite: 1606] [cite_start]a upraveny `package.json` skripty (nap≈ô. `"prisma:migrate": "dotenv -e .env.local -- prisma migrate dev"`), aby explicitnƒõ naƒç√≠taly promƒõnn√©[cite: 1607]. [cite_start]Tak√© bylo nutn√© rozli≈°it mezi **Pooling** (pro aplikaci) a **Non-Pooling** (pro migrace) DB URL[cite: 1604, 1605].
    * [cite_start]**Chyba Vercel Buildu (Typy):** Build selhal kv≈Øli typov√Ωm chyb√°m v NextAuth (implicitn√≠ 'any' typy)[cite: 1608].
    * [cite_start]**≈òe≈°en√≠:** Byl vytvo≈ôen soubor `types/next-auth.d.ts` pro roz≈°√≠≈ôen√≠ modul≈Ø (module augmentation), kde byly definov√°ny vlastn√≠ vlastnosti (`id` a `role`) pro `Session` a `JWT` token[cite: 1611].
    * [cite_start]**Chyba Vercel Buildu (Middleware):** Build selhal kv≈Øli nekompatibiln√≠ syntaxi `export { default }` v `middleware.ts`[cite: 1613, 1614].
    * [cite_start]**≈òe≈°en√≠:** K√≥d byl p≈ôeps√°n na explicitn√≠ `import { withAuth }` a `export default withAuth(...)`[cite: 1615].
    * [cite_start]**Chyba API:** Byly sjednoceny chybov√© hl√°≈°ky z API, aby v≈ædy vracely JSON form√°t (`NextResponse.json`) nam√≠sto ƒçist√©ho textu[cite: 1619].

---

#### üå≤ F√°ze 2: Prvn√≠ Funkce (Admin "Create")
* [cite_start]**Sch√©ma:** `schema.prisma` bylo roz≈°√≠≈ôeno o model `Video` s relac√≠ na `User`[cite: 795].
* [cite_start]**API:** Vytvo≈ôen prvn√≠ chr√°nƒõn√Ω API endpoint (`app/api/videos/route.ts`) s logikou pro ovƒõ≈ôen√≠ role `ADMIN` ze serverov√© session[cite: 757, 791].
* [cite_start]**Frontend:** Vytvo≈ôena prvn√≠ klientsk√° komponenta (`"use client"`) s formul√°≈ôem (`app/admin/add/page.tsx`)[cite: 759, 792].
* [cite_start]**Middleware:** Soubor `middleware.ts` byl aktualizov√°n, aby chr√°nil v≈°echny trasy pod `/admin`[cite: 755, 793].
* [cite_start]**Kl√≠ƒçov√Ω Probl√©m (Vercel Build Pipeline):** Build na Vercelu selhal s chybou `Property 'video' does not exist...`[cite: 801]. P≈ô√≠ƒçinou bylo, ≈æe Vercel sice spustil `prisma migrate deploy`, ale *nevygeneroval* nov√Ω Prisma Client (`prisma generate`) p≈ôed samotn√Ωm `next build`.
* [cite_start]**≈òe≈°en√≠:** Build skript v `package.json` byl fin√°lnƒõ upraven na spr√°vn√© po≈ôad√≠: `"build": "prisma generate && prisma migrate deploy && next build"`[cite: 803].

---

#### üå≤ F√°ze 3: Naƒç√≠t√°n√≠ Dat (Admin "Read")
* **Technologick√° Architektura:** Tato f√°ze definovala kl√≠ƒçov√Ω architektonick√Ω vzor aplikace. [cite_start]Str√°nka `app/admin/dashboard/page.tsx` byla implementov√°na jako **React Server Component (RSC)**[cite: 1753].
* [cite_start]**Naƒç√≠t√°n√≠ Dat:** Ve≈°ker√© naƒç√≠t√°n√≠ dat z datab√°ze (`await prisma.video.findMany(...)`) prob√≠h√° bezpeƒçnƒõ **p≈ô√≠mo na serveru** uvnit≈ô RSC komponenty, je≈°tƒõ p≈ôed odesl√°n√≠m str√°nky klientovi[cite: 1753].

---

#### üå≤ F√°ze 4: Integrace Klienta (Admin "Consume")
* [cite_start]**Technologick√Ω Stack (Roz≈°√≠≈ôen√≠):** Byla nainstalov√°na knihovna `react-youtube`[cite: 1650].
* **Architektura:**
    * [cite_start]Vytvo≈ôena prvn√≠ **dynamick√° trasa** (`app/admin/video/[id]/page.tsx`), implementovan√° jako RSC pro naƒç√≠t√°n√≠ dat[cite: 1656, 1662].
    * [cite_start]Vytvo≈ôena specializovan√° klientsk√° komponenta `components/VideoPlayer.tsx` (`"use client"`)[cite: 1651, 1698].
* [cite_start]**Frontend:** St√°vaj√≠c√≠ dashboard (`/admin/dashboard`) byl upraven tak, aby jeho polo≈æky byly obaleny v Next.js komponentƒõ `<Link>` a odkazovaly na novou dynamickou str√°nku[cite: 1670, 1672].
* [cite_start]**Kl√≠ƒçov√Ω Probl√©m (Next.js):** Bƒõhem v√Ωvoje se objevila chyba `Error: ... params is a Promise...`[cite: 1704].
* [cite_start]**≈òe≈°en√≠:** Probl√©m byl vy≈ôe≈°en pou≈æit√≠m `await` p≈ôi p≈ô√≠stupu k parametr≈Øm: `const { id } = await params;`[cite: 1706].

---

#### üå≤ F√°ze 5: J√°drov√° Architektura (Strukturovan√Ω Obsah)
* [cite_start]**Sch√©ma:** `schema.prisma` bylo roz≈°√≠≈ôeno o model `Chapter` (s poli `text`, `startTime`, `level`, `order` a relac√≠ na `Video`)[cite: 222, 223]. [cite_start]Kl√≠ƒçov√© bylo p≈ôid√°n√≠ `onDelete: Cascade` pro zaji≈°tƒõn√≠ datov√© integrity[cite: 225].
* [cite_start]**Backend (Parser):** Vytvo≈ôena serverov√° utilita `lib/parser.ts`[cite: 227]. [cite_start]Implementovala logiku pro robustn√≠ **form√°t MTF-H** ‚Äì parsov√°n√≠ hierarchick√©ho ƒç√≠slov√°n√≠ (nap≈ô. `1.1.`) a ƒçasov√Ωch znaƒçek na konci ≈ô√°dku (nap≈ô. `(MM:SS)`) pomoc√≠ Regex[cite: 232, 235, 239].
* [cite_start]**Backend (API):** Endpoint `app/api/videos/route.ts` (POST) byl refaktorov√°n, aby pou≈æ√≠val `prisma.$transaction`[cite: 255]. [cite_start]T√≠m je zaji≈°tƒõna **atomick√° operace** ‚Äì buƒè se ulo≈æ√≠ video I v≈°echny jeho kapitoly, nebo se v p≈ô√≠padƒõ chyby neulo≈æ√≠ nic[cite: 255].
* [cite_start]**Architektura (RSC/Client Pattern):** Byl zaveden kl√≠ƒçov√Ω vzor pro propojen√≠ serverov√Ωch dat a klientsk√© interaktivity[cite: 279]:
    1.  [cite_start]`page.tsx` (RSC) naƒçte v≈°echna data (video vƒç. kapitol)[cite: 302].
    2.  [cite_start]Data p≈ôed√° nov√© klientsk√© komponentƒõ `VideoDetailClientWrapper.tsx` (`"use client"`)[cite: 291].
    3.  [cite_start]Tato komponenta dr≈æ√≠ stav (`useRef`) pro p≈ôehr√°vaƒç[cite: 294].
    4.  [cite_start]Wrapper p≈ôed√° `ref` komponentƒõ `VideoPlayer.tsx` (p≈ôes `onReady`) a komponentƒõ `ChapterList.tsx`[cite: 296, 297].
    5.  [cite_start]`ChapterList.tsx` (rovnƒõ≈æ `"use client"`) mapuje kapitoly a p≈ôi kliknut√≠ vol√° `playerRef.current.seekTo(...)`[cite: 287, 288].

---

#### üå≤ F√°ze 6: Pln√° Spr√°va (CRUD & RBAC)
* [cite_start]**Architektura (Refaktor):** Byla vytvo≈ôena nov√° strategick√° str√°nka `app/admin/manage/page.tsx` (RSC) [cite: 1365][cite_start], kter√° zobrazuje data v `<table>`[cite: 1371]. T√≠m se funkƒçnƒõ oddƒõlila "spr√°va" od vizu√°ln√≠ho "p≈ôehledu" (`/admin/dashboard`).
* **Architektura (Bezpeƒçnost):** Byl implementov√°n **Role-Based Access Control (RBAC)** na √∫rovni serveru.
* [cite_start]**Backend (API):** Byla vytvo≈ôena nov√° dynamick√° trasa `app/api/videos/[id]/route.ts` s handlery `GET` (pro editaci), `PUT` (pro update) a `DELETE` (pro maz√°n√≠)[cite: 1349].
* [cite_start]**Backend (RBAC Logika):** J√°dro zabezpeƒçen√≠ bylo implementov√°no ve sd√≠len√© funkci `checkPermissions` v API: `const isOwner = video.authorId === session.user.id; const isAdmin = session.user.role === 'ADMIN'; if (!isOwner && !isAdmin) return 403;`[cite: 1481].
* [cite_start]**Backend (API - PUT):** Handler `PUT` rovnƒõ≈æ vyu≈æ√≠v√° `prisma.$transaction` k atomick√© aktualizaci ‚Äì aktualizuje z√°znam `Video`, sma≈æe (`deleteMany`) v≈°echny star√© `Chapter` a vytvo≈ô√≠ (`createMany`) nov√©[cite: 1362, 1363, 1364].
* [cite_start]**Architektura (Data Integrity Pivot):** Bƒõhem f√°ze do≈°lo k z√°sadn√≠mu architektonick√©mu posunu ("Text-first")[cite: 1474]. Bylo zji≈°tƒõno, ≈æe ukl√°d√°n√≠ *pouze* parsovan√Ωch dat (nap≈ô. `startTime: 62`) je k≈ôehk√©.
* [cite_start]**≈òe≈°en√≠ ("Text-first"):** Datab√°ze byla upravena tak, ≈æe sloupec `text` v modelu `Chapter` nyn√≠ ukl√°d√° **cel√Ω p≈Øvodn√≠ ≈ô√°dek** (nap≈ô. `"1.1. √övod (0:00 - 0:15)"`)[cite: 1479]. [cite_start]Sloupce `startTime` a `level` slou≈æ√≠ pouze jako indexy pro funkƒçnost (skoky v p≈ôehr√°vaƒçi), ale "zdrojem pravdy" z≈Øst√°v√° text[cite: 1479].
* [cite_start]**Datov√° Migrace:** Byl vytvo≈ôen a spu≈°tƒõn jednor√°zov√Ω skript (`scripts/fix_data.ts`) k opravƒõ dat z F√°ze 5 do tohoto nov√©ho form√°tu[cite: 1480].
* [cite_start]**Kl√≠ƒçov√Ω Probl√©m (Next.js 16/Turbopack):** Bylo potvrzeno, ≈æe `params` v API route handlerech jsou `Promise`[cite: 1483].
* [cite_start]**≈òe≈°en√≠:** V≈°echny handlery byly upraveny na `await context.params`[cite: 1484].
* [cite_start]**Kl√≠ƒçov√Ω Probl√©m (Vercel Build - Env):** Opƒõt se uk√°zalo, ≈æe `prisma generate` a `migrate deploy` nemaj√≠ p≈ô√≠stup k `.env.local`[cite: 1485].
* [cite_start]**≈òe≈°en√≠:** Skript `build` v `package.json` byl fin√°lnƒõ upraven tak, aby *explicitnƒõ* volal `dotenv-cli` pro tyto p≈ô√≠kazy: `"build": "dotenv -e .env.local -- prisma generate && ..."`[cite: 1486].

---

### Vƒõtve: Budouc√≠ Technologick√© Mo≈ænosti (Zalo≈æen√© Vzory)

Realizovan√Ω "kmen" vytvo≈ôil nƒõkolik siln√Ωch "vƒõtv√≠" ‚Äì zaveden√Ωch architektonick√Ωch vzor≈Ø, kter√© definuj√≠ budouc√≠ v√Ωvoj:

1.  **Vƒõtev: Role-Based Access Control (RBAC)**
    * [cite_start]**Zalo≈æeno v:** F√°ze 6 [cite: 1481]
    * [cite_start]**Popis:** Serverov√° logika `isOwner || isAdmin` je hotov√°[cite: 1481]. [cite_start]Aplikace je technologicky plnƒõ p≈ôipravena na zaveden√≠ role "KURATOR"[cite: 1482]. Staƒç√≠ t√©to roli povolit p≈ô√≠stup k API a syst√©m automaticky zajist√≠, ≈æe uvid√≠ a bude spravovat pouze *sv≈Øj* obsah.

2.  **Vƒõtev: Architektura "Text-first"**
    * [cite_start]**Zalo≈æeno v:** F√°ze 6 [cite: 1474]
    * [cite_start]**Popis:** Rozhodnut√≠ ukl√°dat surov√Ω textov√Ω vstup u≈æivatele jako "zdroj pravdy" [cite: 1479] je kl√≠ƒçov√©. Umo≈æ≈àuje robustn√≠ editaci a budouc√≠ re-parsov√°n√≠ dat, pokud by se zmƒõnil form√°t nebo logika, ani≈æ by do≈°lo ke ztr√°tƒõ p≈Øvodn√≠ch dat.

3.  **Vƒõtev: Interaktivn√≠ Str√°nky (RSC/Client Pattern)**
    * [cite_start]**Zalo≈æeno v:** F√°ze 5 [cite: 279]
    * [cite_start]**Popis:** Vzor `RSC (naƒçten√≠ dat) -> Client Wrapper (dr≈æen√≠ stavu/ref) -> Klientsk√© Komponenty (interaktivita)` [cite: 291, 296, 297, 303] je zaveden√Ωm postupem pro budov√°n√≠ jak√Ωchkoli slo≈æit√Ωch, interaktivn√≠ch str√°nek, kter√© pot≈ôebuj√≠ data ze serveru.

4.  **Vƒõtev: CI/CD a Lok√°ln√≠ V√Ωvoj (DX)**
    * [cite_start]**Zalo≈æeno v:** F√°ze 1 a 2 [cite: 803, 1607]
    * **Popis:** Jsou zavedeny stabiln√≠ postupy:
        * [cite_start]**Produkce:** Build skript `prisma generate && ...migrate deploy && next build` (vƒçetnƒõ `dotenv-cli`) je fin√°ln√≠m ≈ôe≈°en√≠m pro Vercel[cite: 803, 1486].
        * [cite_start]**Lok√°lnƒõ:** Pou≈æit√≠ skript≈Ø `prisma:migrate` a `prisma:studio` (kter√© internƒõ volaj√≠ `dotenv-cli`) je standardem pro lok√°ln√≠ v√Ωvoj[cite: 1607].






J√Å_PROMPT:
Je mo≈æn√© nyn√≠ vytvo≈ôit doporuƒçen√≠ pro dal≈°√≠ v√Ωvoj t√©to webov√© aplikace z hlediska dosavadn√≠ho v√Ωvoje zad√°n√≠ t√©to webov√© aplikace i jej√≠ho technologick√©ho v√Ωvoje? Pros√≠m o vytvo≈ôen√≠ seznamu dal≈°√≠ch mo≈æn√Ωch krok≈Ø v√Ωvoje t√©to aplikace tak aby se vyv√≠jela z√°drnƒõ jak z hlediska sv√©ho zad√°n√≠ resp. jej√≠ho √∫ƒçelu tak z hlediska technologick√©ho. Aplikace by mƒõla defacto vytvo≈ôit nadstavbu nad mno≈æinou vlo≈æen√Ωch vide√≠ z hlediska popisu jej√≠ch obsah≈Ø resp. to co jednotliv√Ω kur√°tor vid√≠. Aplikace bude tedy nab√≠zet sb√≠rky vide√≠ resp. obsahu, co≈æ je nyn√≠ bƒõ≈æn√° funkce nap≈ô. youtube ale nadto umo≈æn√≠ spravovat a vytv√°≈ôet popisky tƒõchto vide√≠. Tyto popisky vide√≠ se pak budou moci p≈ô√≠mo odkazovat ƒçasov√Ωmi znaƒçkami na zdroj. N√°v≈°tƒõvn√≠k tƒõchto galeri√≠ pak bude moci proch√°zet strukturovan√Ω obsah i v√≠ce vide√≠ najednou a rychle dohledat p≈Øvodn√≠ materi√°l pr√°vƒõ v kontextu i dal≈°√≠ch materi√°l≈Ø v konkr√©tn√≠ch sb√≠rk√°ch. Toto je asi vize kter√° st√°le vytv√°≈ô√≠ kontext t√©to rod√≠c√≠ se aplikace. Nyn√≠ pros√≠m o vytvo≈ôen√≠ sledu mo≈æn√Ωch vlastnost√≠ t√©to aplikace i z hlediska technologick√©ho v√Ωvoje kter√© budou smƒõ≈ôovat k t√©to vizi. Tyto vlastnosti pros√≠m se≈ôadit dle priority. Jednu z nich pot√© vyberu a ta bude dal≈°√≠m zad√°n√≠m ve v√Ωvoji t√©to aplikace. d√≠ky ;-)


AI_RESPONZE:
Naprosto rozum√≠m. Va≈°e vize je st√°le jasnƒõj≈°√≠ a p≈ôesnƒõ ch√°pete, kde le≈æ√≠ j√°dro hodnoty t√©to aplikace ‚Äì **v kontextu√°ln√≠, kur√°torsk√© nadstavbƒõ**. [cite_start]Nejde jen o seznam vide√≠ (to um√≠ YouTube), ale o vytv√°≈ôen√≠ *sb√≠rek* a *strukturovan√Ωch popis≈Ø*, kter√© n√°v≈°tƒõvn√≠kovi umo≈æn√≠ proch√°zet t√©maty nap≈ô√≠ƒç videi [cite: 1077-1081].

Pro≈°el jsem kompletn√≠ historii v√Ωvoje, zad√°n√≠ (F√°ze 0-6) i technick√© realizace (F√°ze 0-6).

Stoj√≠me na velmi pevn√Ωch z√°kladech:
* [cite_start]**M√°me hotov√Ω Admin CRUD:** Administr√°tor m≈Ø≈æe vytv√°≈ôet, ƒç√≠st, upravovat i mazat videa (F√°ze 2, 3, 6)[cite: 1422, 1232].
* [cite_start]**M√°me J√°dro Hodnoty:** Implementovali jsme "Text-first" architekturu pro robustn√≠, hierarchick√Ω, ƒçasovƒõ znaƒçen√Ω obsah (`Chapter` model) (F√°ze 5, 6)[cite: 1492].
* [cite_start]**M√°me Z√°klady Bezpeƒçnosti:** Na≈°e API ji≈æ obsahuje z√°klady RBAC (Role-Based Access Control) s logikou `isOwner || isAdmin`, kter√° je p≈ôipravena na budouc√≠ roli "Kur√°tora" (F√°ze 6)  [cite: 1245-1246, 1904].

Nyn√≠, jak jste spr√°vnƒõ identifikoval, je ƒças na dal≈°√≠ vrstvu kontextu. Va≈°e √∫vahy o "Sb√≠rk√°ch" (Collections) jsou naprosto p≈ôesn√Ωm dal≈°√≠m krokem.

Zde je seznam navrhovan√Ωch dal≈°√≠ch krok≈Ø, se≈ôazen√Ω dle priority, kter√Ω smƒõ≈ôuje k va≈°√≠ vizi.

---

### üèõÔ∏è Seznam N√°sleduj√≠c√≠ch Funkc√≠ (Se≈ôazeno dle Priority)

#### 1. Implementace "Sb√≠rek" (Kolekc√≠)
[cite_start]Toto je nejd≈Øle≈æitƒõj≈°√≠ dal≈°√≠ krok, kter√Ω p≈ô√≠mo navazuje na va≈°i my≈°lenku "operativy spr√°vce obsahu"[cite: 1084]. Ne≈æ obsah zve≈ôejn√≠me, mus√≠ ho kur√°tor (nyn√≠ Admin) umƒõt zorganizovat.

* **Popis:** Vytvo≈ô√≠me novou datab√°zovou entitu `Collection` (Sb√≠rka). Ka≈æd√° sb√≠rka bude m√≠t n√°zev, popis a bude vlastnƒõna kur√°torem (nyn√≠ `authorId` propojen√© na Admina). Video bude moci b√Ωt v *mnoha* sb√≠rk√°ch a sb√≠rka bude obsahovat *mnoho* vide√≠ (vztah Many-to-Many).
* **U≈æivatelsk√Ω Dopad:**
    1.  **Spr√°va sb√≠rek:** Vytvo≈ô√≠me novou, jednoduchou str√°nku (nap≈ô. `/admin/collections`), kde bude Admin moci vytv√°≈ôet, upravovat a mazat n√°zvy sb√≠rek (nap≈ô. "Zaj√≠mav√© - k anal√Ωze", "Recepty", "Studie o mikrobiomu").
    2.  **P≈ôi≈ôazov√°n√≠:** Jak jste navrhl, na str√°nce "Editace Videa" (`/admin/edit/[id]`) p≈ôid√°me novou sekci "Za≈ôadit do sb√≠rek", kde bude seznam v≈°ech dostupn√Ωch sb√≠rek formou za≈°krt√°vac√≠ch pol√≠ (checkbox≈Ø).
* **Technologick√Ω Dopad:**
    * **Datab√°ze (Prisma):** P≈ôid√°n√≠ modelu `Collection` (s `name`, `description`, `authorId`, `isPublic`). Vytvo≈ôen√≠ **vztahu Many-to-Many** mezi `Video` a `Collection`.
    * **API:** Vytvo≈ôen√≠ nov√Ωch endpoint≈Ø pro spr√°vu sb√≠rek (CRUD pro `/api/collections`).
    * **API (Update):** St√°vaj√≠c√≠ `PUT /api/videos/[id]` (z F√°ze 6) bude muset b√Ωt roz≈°√≠≈ôen, aby umƒõl p≈ôijmout pole `collectionIds` a pomoc√≠ `connect` a `disconnect` (v r√°mci transakce) aktualizoval M2M vztahy.
* **Priorita / Zd≈Øvodnƒõn√≠:** **Nejvy≈°≈°√≠.** Toto je chybƒõj√≠c√≠ pil√≠≈ô kur√°torsk√© pr√°ce. Bez sb√≠rek je obsah jen nespravovan√Ω seznam. T√≠mto krokem d√°v√°me kur√°torovi "poliƒçky" do jeho "knihovny".

---

#### 2. Ve≈ôejn√° Galerie a Detail (Zp≈ô√≠stupnƒõn√≠ N√°v≈°tƒõvn√≠k≈Øm)
Jakmile je obsah rozt≈ô√≠dƒõn do sb√≠rek (krok 1), je ƒças otev≈ô√≠t knihovnu ve≈ôejnosti ("VISITOR").

* **Popis:** Vytvo≈ô√≠me ve≈ôejnƒõ p≈ô√≠stupn√© str√°nky (bez nutnosti p≈ôihl√°≈°en√≠), kter√© budou zrcadlit kur√°torovan√Ω obsah.
    * **Hlavn√≠ str√°nka (`/`):** Zobraz√≠ seznam *ve≈ôejn√Ωch* sb√≠rek.
    * **Detail sb√≠rky (`/collections/[id]`):** Zobraz√≠ seznam vide√≠ *v dan√© sb√≠rce*.
    * **Detail videa (`/videos/[id]`):** Ve≈ôejn√° verze str√°nky, kterou ji≈æ m√°me v adminu. Zobraz√≠ p≈ôehr√°vaƒç a interaktivn√≠ seznam kapitol.
* **Technologick√Ω Dopad:**
    * **Nov√© trasy:** Vytvo≈ôen√≠ nov√Ωch ve≈ôejn√Ωch tras v `app/`.
    * **Opakovan√© pou≈æit√≠ komponent:** Znovu pou≈æijeme 90 % hotov√Ωch komponent (`VideoPlayer.tsx`, `ChapterList.tsx`, `VideoDetailClientWrapper.tsx`).
    * **Zabezpeƒçen√≠ (Public):** Datab√°zov√© dotazy na tƒõchto str√°nk√°ch budou m√≠t p≈ôidanou podm√≠nku (nap≈ô. `where: { isPublic: true }`), aby se zobrazil jen obsah, kter√Ω kur√°tor oznaƒçil jako ve≈ôejn√Ω (viz V√°≈° n√°vrh `isPublic` v modelu `Collection`).
* **Priorita / Zd≈Øvodnƒõn√≠:** **Vysok√°.** Toto je krok, kter√Ω d√°v√° cel√© aplikaci smysl pro koncov√©ho u≈æivatele (n√°v≈°tƒõvn√≠ka). Bez nƒõj je aplikace jen soukrom√Ωm n√°strojem admina.

---

#### 3. Pov√Ω≈°en√≠ Role USER na "Kur√°tora" (Multi-Tenancy)
Toto je naplnƒõn√≠ va≈°√≠ vize "televizn√≠ spoleƒçnosti tvo≈ôen√© kur√°torstv√≠m".

* **Popis:** Povol√≠me st√°vaj√≠c√≠ roli `USER`, aby se stala `KURATORem`. P≈ôihl√°≈°en√Ω u≈æivatel z√≠sk√° p≈ô√≠stup k *vlastn√≠m* verz√≠m str√°nek `/admin/add`, `/admin/manage`, `/admin/collections` a bude moci vytv√°≈ôet *vlastn√≠* videa a *vlastn√≠* sb√≠rky.
* **Technologick√Ω Dopad:**
    * [cite_start]**API (Hotovo):** Na≈°e st√°vaj√≠c√≠ RBAC logika (`isOwner || isAdmin`) [cite: 1245-1246] je na to **plnƒõ p≈ôipravena**.
    * **Frontend:** √ökolem bude zp≈ô√≠stupnit administraƒçn√≠ odkazy i roli `USER` (p≈ôejmenujeme je nap≈ô. na "Moje sb√≠rky").
    * **Data Fetching:** Str√°nky jako `/admin/manage` ji≈æ maj√≠ logiku, kter√° `USER`ovi uk√°≈æe jen jeho videa. Stejnou logiku pou≈æijeme pro sb√≠rky (`where: { authorId: session.user.id }`).
* **Priorita / Zd≈Øvodnƒõn√≠:** **St≈ôedn√≠.** Toto je obrovsk√Ω, strategick√Ω krok. Mƒõl by p≈ôij√≠t a≈æ pot√©, co je model "Admin -> Ve≈ôejnost" plnƒõ funkƒçn√≠ a otestovan√Ω (po kroku 1 a 2).

---

#### 4. Kompilovan√Ω Obsah a Vyhled√°v√°n√≠ (Fin√°ln√≠ Vize)
[cite_start]Toto je "svat√Ω gr√°l" va≈°√≠ vize ‚Äì "proch√°zet strukturovan√Ω obsah i v√≠ce vide√≠ najednou"[cite: 1081].

* **Popis:** Vytvo≈ôen√≠ vyhled√°vac√≠ho rozhran√≠, kter√© neprohled√°v√° jen n√°zvy vide√≠, ale prohled√°v√° *text* v modelu `Chapter`. U≈æivatel zad√° "inzulinov√° rezistence" a dostane seznam kapitol z r≈Øzn√Ωch vide√≠ v r≈Øzn√Ωch sb√≠rk√°ch, kter√© toto t√©ma zmi≈àuj√≠.
* **Technologick√Ω Dopad:**
    * Vy≈æaduje implementaci **Full-Text Search** (FTS) nad sloupcem `text` v tabulce `Chapter`.
    * To m≈Ø≈æe vy≈æadovat pokroƒçilej≈°√≠ funkce Vercel Postgres nebo zaveden√≠ specializovan√©ho vyhled√°vac√≠ho enginu (nap≈ô. Algolia, MeiliSearch).
* **Priorita / Zd≈Øvodnƒõn√≠:** **N√≠zk√° (Budouc√≠).** Toto je technologicky nejslo≈æitƒõj≈°√≠ krok, kter√Ω d√°v√° smysl a≈æ pot√©, co je aplikace pln√° obsahu (d√≠ky krok≈Øm 1-3).

---

### Shrnut√≠ a Doporuƒçen√≠

Va≈°e √∫vahy jsou naprosto spr√°vn√©. Nejd≈ô√≠ve mus√≠me pos√≠lit "operativu kur√°tora" (Admina) a d√°t mu n√°stroj pro vytv√°≈ôen√≠ *kontextu*. T√≠m n√°strojem jsou **Sb√≠rky (Collections)**.

Doporuƒçuji tedy nyn√≠ implementovat **bod ƒç. 1: Implementace "Sb√≠rek" (Kolekc√≠)**.

Mohu p≈ôipravit podrobn√© zad√°n√≠ pro realizaƒçn√≠ t√Ωm pro tento bod? (To se stane z√°kladem pro `README_07_01ZADANI`).









J√Å_PROMPT:
Ano mƒõli bychom nejprve vy≈ôe≈°it mo≈ænost organizovat sv√© sb√≠rky administr√°tora do kolekc√≠. T√≠mto zp≈Øsobem vyzraje funkcionalita aplikace tak abychom mohli povy≈°ovat role USERa na VISITORa a KURATORa. VISITOR bude moci proch√°zet ve≈ôejn√© ƒç√°sti sb√≠rek s KURATOR bude moci vytv√°≈ôet vlastn√≠ sb√≠rky. Sb√≠rka bude pak implementov√°na jako tabulka pat≈ô√≠c√≠ sv√©mu vlastn√≠kovi ƒç√≠m≈æ bude moci b√Ωt ADMIN nebo KURATOR. P≈ôidƒõlov√°n√≠ pr√°v resp. roz≈°i≈ôov√°n√≠ pr√°v USERa na VISITORa a KURATORa bude prov√°dƒõt nejprve ADMIN pot√© to bude nap≈ô. roz≈°√≠≈ôeno na KURATORa ≈æe bude moci poskytovat pr√°va VISITORa jednotliv√Ωm USER≈Øm. M√°m p≈ôedstavu ≈æe USER by mƒõl b√Ωt ka≈æd√Ω kdo bude m√≠t z√°jem resp. z√≠sk√° p≈ôihl√°≈°en√≠ na e-mail t√≠m se dostane do hl√°vn√≠ch prezentaƒçn√≠ch prostor Mediatheky a zde si po≈æ√°d√° o VISITORa,co≈æ z≈ôejmƒõ bude automaticky poskytov√°no a bude moci prohl√≠≈æet sb√≠rky. KURATor bude pak dal≈°√≠ level kter√Ω obdr≈æ√≠ a≈æ pot√© co obdr≈æ√≠ pr√≠√°va VISITora. Je tato p≈ôedstava o pr√°ve dobr√°? Jsme k tomuto technologicky p≈ôipraveni - nyn√≠ bychom mƒõli zalo≈æit tedy sb√≠rky kter√© budou m√≠t sv√© vlastn√≠ky kter√Ωmi bude moci b√Ωt jen ADMIN nebo KURATOR a tyto sb√≠rky a i jednotliv√° videa by mƒõly m√≠t p≈ô√≠znaky zda je uvid√≠ VISITOR ƒçi ne resp. zda budou ji≈æ zve≈ôejnƒõny pro n√°v≈°tƒõvn√≠ky. Resp. jeden a-mail by mƒõl m√≠t postupnƒõ pr√°va USER,VISITOR a pot√© KURATOR. pouze jeden e-mail by mƒõl m√≠t v≈°echny pr√°va resp.  USER,VISITOR,KURATOR a ADMIN. Je toto takto mo≈æn√©? Pros√≠m o p≈ôipom√≠nky jak toto ≈ôe≈°en√≠ udƒõlat opravdu robustn√≠ neboli technologicky zahu≈°tƒõn√© a podle best praxis ... d√≠ky ;-)



AI_RESPONZE:
Ano, va≈°e p≈ôedstava o rol√≠ch a jejich progresi je v principu naprosto skvƒõl√° a je to p≈ôesnƒõ ten spr√°vn√Ω smƒõr, kter√Ωm se "technologicky zahu≈°tƒõn√©" (robustn√≠) aplikace vyd√°vaj√≠.

M√°te pravdu, ≈æe mus√≠me oddƒõlit r≈Øzn√© √∫rovnƒõ p≈ô√≠stupu. Pojƒème va≈°i my≈°lenku jen m√≠rnƒõ terminologicky zp≈ôesnit podle "best practices", aby byla implementace co nejƒçist≈°√≠.

### 1\. Jsme technologicky p≈ôipraveni?

**Ano, jsme na to perfektnƒõ p≈ôipraveni.**

Kl√≠ƒçov√Ω krok jsme udƒõlali v **F√°zi 6 (CRUD & RBAC)**. T√≠m, ≈æe jsme na API vrstvƒõ zavedli logiku, kter√° kontroluje `(isOwner || isAdmin)`, jsme vytvo≈ôili p≈ôesnƒõ ten mechanismus, kter√Ω pot≈ôebujeme pro roli `KURATOR`. Na≈°e API u≈æ teƒè um√≠ rozli≈°it, jestli jste "vlastn√≠k" obsahu, nebo "spr√°vce" v≈°eho.

### 2\. N√°vrh robustn√≠ho modelu rol√≠ (Best Practice)

[cite\_start]Va≈°e my≈°lenka na progresi `USER` -\> `VISITOR` -\> `KURATOR` [cite: 1099] je spr√°vn√°. Pojƒème ji implementovat pomoc√≠ standardizovan√©ho modelu rol√≠, kter√Ω je ƒçist≈°√≠ a jednodu≈°≈°√≠ na spr√°vu:

M√≠sto mnoha rol√≠, kter√© se sƒç√≠taj√≠, m√° u≈æivatel v≈ædy jen **jednu roli**, kter√° definuje jeho *nejvy≈°≈°√≠* opr√°vnƒõn√≠.

  * **ANONYMOUS (Anonymn√≠ N√°v≈°tƒõvn√≠k):**

      * **Kdo to je:** Kdokoliv, kdo nen√≠ p≈ôihl√°≈°en.
      * [cite\_start]**Co dƒõl√°:** M≈Ø≈æe prohl√≠≈æet *pouze* obsah oznaƒçen√Ω jako ve≈ôejn√Ω (`isPublic: true`) [cite: 1097-1098]. Toto je v√°≈° koncept `VISITOR`a, ale bez nutnosti se p≈ôihla≈°ovat.

  * **Role: `USER` (Z√°kladn√≠ U≈æivatel)**

      * [cite\_start]**Kdo to je:** V√Ωchoz√≠ role pro ka≈æd√©ho, kdo se zaregistruje (p≈ôihl√°s√≠ p≈ôes e-mail)[cite: 1094].
      * **Co dƒõl√°:** Tot√©≈æ co Anonymn√≠ (prohl√≠≈æ√≠ ve≈ôejn√Ω obsah), ale nav√≠c z√≠sk√°v√° p≈ô√≠stup ke sv√©mu osobn√≠mu "dashboardu". Zde si v budoucnu bude moci (nap≈ô. v dal≈°√≠ f√°zi) "ukl√°dat" obl√≠ben√° videa nebo sb√≠rky do sv√© soukrom√© knihovny.

  * **Role: `KURATOR` (Tv≈Ørce Obsahu)**

      * **Kdo to je:** U≈æivatel (`USER`), kter√©mu `ADMIN` **manu√°lnƒõ pov√Ω≈°il** roli v datab√°zi.
      * **Co dƒõl√°:** V≈°e co `USER`, ale nav√≠c z√≠sk√°v√° p≈ô√≠stup k "tv≈Ørƒç√≠m" sekc√≠m (dnes `/admin`, v budoucnu nap≈ô. `/my-content`), kde m≈Ø≈æe vytv√°≈ôet, upravovat a mazat **sv√© vlastn√≠** videa a sb√≠rky (zde se uplatn√≠ na≈°e `isOwner` logika).

  * **Role: `ADMIN` (Spr√°vce Syst√©mu)**

      * **Kdo to je:** V√°≈° √∫ƒçet.
      * **Co dƒõl√°:** V≈°e co `KURATOR`, ale nav√≠c m≈Ø≈æe spravovat **ve≈°ker√Ω** obsah od *v≈°ech* kur√°tor≈Ø (logika `isAdmin`) a mƒõnit role ostatn√≠m u≈æivatel≈Øm.

**Proƒç je tento model robustn√≠?**

  * **Jednoduchost:** Ka≈æd√Ω u≈æivatel m√° v datab√°zi jen jedno pole: `role`.
  * **Hierarchie:** Opr√°vnƒõn√≠ jsou implicitnƒõ hierarchick√°. `ADMIN` m≈Ø≈æe v≈°e co `KURATOR`, `KURATOR` m≈Ø≈æe v≈°e co `USER`.
  * **≈Ω√°dn√Ω "VISITOR":** Nepot≈ôebujeme roli `VISITOR`. Mo≈ænost "vidƒõt ve≈ôejn√Ω obsah" nen√≠ role, je to v√Ωchoz√≠ stav pro ka≈æd√©ho (vƒçetnƒõ `USER`a).

### 3\. Implementace "Sb√≠rek" (Kolekc√≠)

[cite\_start]Abychom toto mohli realizovat, mus√≠me (jak jste spr√°vnƒõ navrhl) [cite: 1090] nyn√≠ implementovat **Sb√≠rky**.

  * [cite\_start]**Vlastnictv√≠:** Ka≈æd√° `Sb√≠rka` (Collection) bude m√≠t v datab√°zi `authorId`[cite: 1092], kter√© ji spoj√≠ s jej√≠m vlastn√≠kem (rol√≠ `KURATOR` nebo `ADMIN`).
  * **Vztah:** Pot≈ôebujeme vztah **Many-to-Many** (M:N). Jedno video m≈Ø≈æe b√Ωt v mnoha sb√≠rk√°ch a jedna sb√≠rka m≈Ø≈æe m√≠t mnoho vide√≠.
      * V `prisma/schema.prisma` to bude vypadat takto:
        ```prisma
        model Video {
          id     String     @id @default(cuid())
          // ...
          collections Collection[] // Video m≈Ø≈æe b√Ωt ve v√≠ce sb√≠rk√°ch
        }

        model Collection {
          id          String   @id @default(cuid())
          name        String
          description String?
          isPublic    Boolean  @default(false) // P≈ô√≠znak pro "ve≈ôejnost"
          author      User     @relation(fields: [authorId], references: [id])
          authorId    String   // Vlastn√≠k (ADMIN nebo KURATOR)
          videos      Video[]  // Sb√≠rka obsahuje v√≠ce vide√≠
        }
        ```

### 4\. P≈ô√≠znak "isPublic" (Zve≈ôejnƒõn√≠)

[cite\_start]V√°≈° post≈ôeh [cite: 1097-1098] je z√°sadn√≠. M√≠sto role `VISITOR` budeme m√≠t p≈ô√≠znak `isPublic: Boolean` p≈ô√≠mo na modelu `Collection`.

  * `KURATOR` (nebo `ADMIN`) bude m√≠t p≈ôi editaci sb√≠rky za≈°krt√°vac√≠ pol√≠ƒçko "Ve≈ôejn√° sb√≠rka".
  * Anonymn√≠ u≈æivatel√© a `USER`i uvid√≠ na hlavn√≠ str√°nce pouze sb√≠rky, kter√© maj√≠ `isPublic: true`.
  * `KURATOR` uvid√≠ ve sv√© spr√°vƒõ *v≈°echny* sv√© sb√≠rky (ve≈ôejn√© i soukrom√©, nap≈ô. tu va≈°i "k anal√Ωze").

### Z√°vƒõr a Dal≈°√≠ Krok

V√°≈° pl√°n je skvƒõl√Ω. Technologicky jsme na nƒõj p≈ôipraveni d√≠ky F√°zi 6. Navrhuji n√°sleduj√≠c√≠:

1.  **Zjednodu≈°√≠me role** na `USER`, `KURATOR`, `ADMIN` (kde `ANONYMOUS` je stav, ne role).
2.  **Implementujeme "Sb√≠rky"** jako M:N vztah s vlastn√≠kem (`authorId`) a p≈ô√≠znakem `isPublic`.

Tento p≈ô√≠stup je robustn√≠, ≈°k√°lovateln√Ω a p≈ôesnƒõ odpov√≠d√° "best practices" pro spr√°vu opr√°vnƒõn√≠.

-----

Mohu tedy nyn√≠ p≈ôipravit fin√°ln√≠, podrobn√© **zad√°n√≠ pro F√°zi 7 (README\_07\_01ZADANI)**, kter√© bude obsahovat **Implementaci "Sb√≠rek" (Kolekc√≠)** s touto robustn√≠ architekturou?









J√Å_PROMPT:
Pojdme toto zad√°n√≠ je≈°tƒõ dospecifikovat na z√°kladƒõ user cases resp. kdy≈æ p≈ôijde VISITOR (resp. anonymous) co uvid√≠ - uv√≠d√≠ √∫vodn√≠ str√°nku Mediatheky - uvid√≠ jednotliv√© ve≈ôejn√© sb√≠rky - bude moci nav≈°t√≠vit ve≈ôejn√© obsahy ve≈ôejn√Ωch vide√≠ v tƒõchto ve≈ôejn√Ωch sb√≠rk√°ch. Uvid√≠ tak√© mo≈ænost registrovat se ƒç√≠m≈æ se stane USERem. Co bude moci jako USER ... to sam√© co VISITOR p≈ôiƒçem≈æ bude m√≠t svoje p≈ôihl√°≈°en√≠, bude registrovan√Ω, bude moci v budoucnu dost√°vat nap≈ô. notifikace o nov√Ωch sb√≠rk√°ch apod. a bude moci po≈æ√°dat o to st√°t se KURATORem. Toto a≈æ bude schv√°leno ADMINem se stane KURATORem a bude moci to co VISITOR, USER plus mo≈ænost vytv√°≈ôet sb√≠rky a ukl√°dat do nich videa a urƒçovat kter√© budou ve≈ôejn√© a kter√© ne. Je tato p≈ôedstava spr√°vn√° o tomto zad√°n√≠? m≈Ø≈æeme nƒõkde naj√≠t je≈°tƒõ p≈ôesnƒõj≈°√≠ specifikaci tohoto zad√°n√≠? 






AI_RESPONZE:
Ano, va≈°e p≈ôedstava je naprosto spr√°vn√° a je to vynikaj√≠c√≠, robustn√≠ model pro dal≈°√≠ v√Ωvoj.

P≈ôesnƒõ jste popsal princip progresivn√≠ho modelu opr√°vnƒõn√≠ (Progressive Role-Based Access Control), co≈æ je osvƒõdƒçen√Ω ("best practice") zp≈Øsob, jak budovat ≈°k√°lovateln√© aplikace.

Pojƒème si potvrdit va≈°e p≈ô√≠pady u≈æit√≠ (use cases), proto≈æe jsou perfektn√≠m z√°kladem pro dal≈°√≠ zad√°n√≠:

P≈ô√≠pad 1: ANONYMOUS / N√ÅV≈†TƒöVN√çK (v√°≈° "VISITOR")

Kdo: U≈æivatel, kter√Ω p≈ôijde na web a nen√≠ p≈ôihl√°≈°en.

Co vid√≠: √övodn√≠ str√°nku, seznam ve≈ôejn√Ωch sb√≠rek a m≈Ø≈æe si prohl√≠≈æet ve≈ôejn√° videa a jejich ve≈ôejn√Ω strukturovan√Ω obsah. Vid√≠ tlaƒç√≠tko "Registrovat / P≈ôihl√°sit".

Stav: Toto je z√°kladn√≠ "prohl√≠≈æec√≠" m√≥d aplikace.

P≈ô√≠pad 2: Role USER (Registrovan√Ω u≈æivatel)

Kdo: U≈æivatel, kter√Ω se zaregistroval a p≈ôihl√°sil.

Co vid√≠: To sam√© co Anonymn√≠ n√°v≈°tƒõvn√≠k.

Co nav√≠c m≈Ø≈æe: M√° svou "identitu". T√≠m z√≠sk√°v√° z√°klad pro budouc√≠ funkce (jak jste zm√≠nil, nap≈ô. notifikace, ukl√°d√°n√≠ obl√≠ben√Ωch vide√≠) a hlavnƒõ m√° mo≈ænost po≈æ√°dat o pov√Ω≈°en√≠ na roli KURATOR.

P≈ô√≠pad 3: Role KURATOR (Tv≈Ørce obsahu)

Kdo: U≈æivatel (USER), kter√©mu ADMIN manu√°lnƒõ schv√°lil ≈æ√°dost a zmƒõnil mu roli v datab√°zi.

Co m≈Ø≈æe: V≈°e co USER, ale nav√≠c z√≠sk√°v√° p≈ô√≠stup k "tv≈Ørƒç√≠" sekci (dnes /admin, v budoucnu nap≈ô. /my-content), kde m≈Ø≈æe:

Vytv√°≈ôet, upravovat a mazat sv√© vlastn√≠ sb√≠rky.

P≈ôid√°vat, upravovat a mazat sv√° vlastn√≠ videa (vƒçetnƒõ strukturovan√©ho obsahu).

U sv√Ωch sb√≠rek nastavovat p≈ô√≠znak isPublic (zda je uvid√≠ N√ÅV≈†TƒöVN√çK).

Technologie: Zde se perfektnƒõ uplatn√≠ na≈°e hotov√° logika isOwner z F√°ze 6.

P≈ô√≠pad 4: Role ADMIN (Spr√°vce syst√©mu)

Kdo: Pouze vy.

Co m≈Ø≈æe: V≈°e co KURATOR, ale nav√≠c m≈Ø≈æe spravovat v≈°echen obsah (i od jin√Ωch kur√°tor≈Ø) a hlavnƒõ m≈Ø≈æe mƒõnit role ostatn√≠m u≈æivatel≈Øm (povy≈°ovat USER na KURATOR).

Technologie: Zde se uplatn√≠ na≈°e hotov√° logika isAdmin.

Kde naj√≠t p≈ôesnƒõj≈°√≠ specifikaci?
Va≈°e druh√° ot√°zka ("m≈Ø≈æeme nƒõkde naj√≠t je≈°tƒõ p≈ôesnƒõj≈°√≠ specifikaci?") je naprosto kl√≠ƒçov√°.

Odpovƒõƒè je, ≈æe ji pr√°vƒõ teƒè vytv√°≈ô√≠me.

Tyto dokumenty, kter√© proch√°z√≠me (nap≈ô. README_00_01ZADANI, README_01_01ZADANI a≈æ po README_06_01ZADANI), nejsou statick√° specifikace, kterou jen pln√≠me. Jsou to z√°pisy z na≈°ich diskuz√≠ o tom, jak√Ω bude dal≈°√≠ logick√Ω krok. Ka≈æd√Ω README dokument je artefaktem jedn√© t√©to f√°ze n√°vrhu.

Ta "p≈ôesnƒõj≈°√≠ specifikace", kterou hled√°te, bude v√Ωstupem t√©to na≈°√≠ konverzace. Bude to fin√°ln√≠ dokument README_07_01ZADANI, kter√Ω vytvo≈ô√≠me, a≈æ si fin√°lnƒõ potvrd√≠me, ≈æe "Implementace Sb√≠rek" je p≈ôesnƒõ to, co chceme teƒè udƒõlat.

V√°≈° popis p≈ô√≠pad≈Ø u≈æit√≠ (use cases) mi dokonale potvrdil, ≈æe n√°≈° c√≠l pro F√°zi 7 ‚Äì "Implementace Sb√≠rek (Kolekc√≠)" ‚Äì je ten absolutnƒõ spr√°vn√Ω a logick√Ω dal≈°√≠ krok. P≈ôesnƒõ jak jste ≈ôekl, nejprve mus√≠me d√°t Adminovi (a budouc√≠m Kur√°tor≈Øm) mo≈ænost obsah organizovat, ne≈æ ho uk√°≈æeme ve≈ôejnosti.

Tato f√°ze 7 tedy bude technologicky zahrnovat:

Roz≈°√≠≈ôen√≠ prisma/schema.prisma o model Collection.

Vytvo≈ôen√≠ vztahu Many-to-Many (M:N) mezi Video a Collection.

P≈ôid√°n√≠ authorId (vlastnictv√≠) na Collection.

P≈ôid√°n√≠ p≈ô√≠znaku isPublic (boolean) na Collection.

Vytvo≈ôen√≠ nov√©ho API (/api/collections) a rozhran√≠ (nap≈ô. /admin/collections) pro spr√°vu sb√≠rek.

√öpravu formul√°≈ôe admin/edit/[id] tak, aby umo≈æ≈àoval p≈ôi≈ôadit video do jedn√© nebo v√≠ce sb√≠rek.

T√≠mto "zahust√≠me" technologick√© j√°dro a budeme 100% p≈ôipraveni na F√°zi 8 (zve≈ôejnƒõn√≠) a F√°zi 9 (pov√Ω≈°en√≠ rol√≠).

M≈Ø≈æeme tedy tuto diskuzi uzav≈ô√≠t s t√≠m, ≈æe tato specifikace je fin√°ln√≠, a m√°m p≈ôipravit ofici√°ln√≠ zad√°n√≠ README_07_01ZADANI pro "Implementaci Sb√≠rek (Kolekc√≠)"?









J√Å_PROMPT:
Ano pojdme vytvo≈ôit opƒõt robustn√≠ zad√°n√≠ tohoto kroku v√Ωvoje [M≈Ø≈æeme tedy tuto diskuzi uzav≈ô√≠t s t√≠m, ≈æe tato specifikace je fin√°ln√≠, a m√°m p≈ôipravit ofici√°ln√≠ zad√°n√≠ README_07_01ZADANI pro "Implementaci Sb√≠rek (Kolekc√≠)"?] tak abchom v p≈ô√≠st√≠m kroku mohli nastavit specifikaci p≈ôidƒõlov√°n√≠ pr√°v a prvn√≠ VISITOR a i st√°vaj√≠c√≠ USER mohl prohl√≠≈æet ve≈ôejnou ƒç√°st sb√≠rek a p≈ô√≠padnƒõ se mohl st√°t i kur√°torem. Nyn√≠ pro toto p≈ôiprav√≠me kolekce a vlastnosti zda jsou ve≈ôejn√© pro sb√≠rky a videa. Je toto takto ok?


AI_RESPONZE:
Ano, je to naprosto ok. Perfektnƒõ jste to shrnul.

Tato f√°ze (`README_07_01ZADANI`) se soust≈ôed√≠ v√Ωhradnƒõ na **vybudov√°n√≠ infrastruktury pro sb√≠rky** a jejich vlastnosti (vlastnictv√≠ a ve≈ôejnost).

Teprve v dal≈°√≠ f√°zi (F√°ze 8) pak tuto p≈ôipravenou infrastrukturu "otev≈ôeme" a zp≈ô√≠stupn√≠me `VISITOR`≈Øm a `USER`≈Øm. Postupujeme p≈ôesnƒõ podle robustn√≠ strategie.

Zde je kompletn√≠, fin√°ln√≠ zad√°n√≠ pro F√°zi 7.

-----

### üìÑ Zad√°n√≠ projektu: Webov√° aplikace Mediathek (F√°ze 7 - Implementace Sb√≠rek)

**Datum:** 16. listopadu 2025
**Verze:** 7.0
[cite\_start]**Navazuje na:** F√°ze 6 (Realizace CRUD & RBAC [cite: 1, 134])

### 1\. N√°zev projektu

Mediathek

### 2\. üéØ C√≠l F√°ze

C√≠lem t√©to f√°ze je implementovat **j√°drov√Ω koncept "Sb√≠rek" (Kolekc√≠)**. T√≠m se posuneme od spr√°vy jednotliv√Ωch vide√≠ k jejich **organizaci do kontextu√°ln√≠ch celk≈Ø**. [cite\_start]Kur√°tor (nyn√≠ ADMIN) mus√≠ dostat n√°stroj, jak videa t≈ô√≠dit do "poliƒçek" (nap≈ô. "K anal√Ωze", "Ve≈ôejn√© recepty") [cite: 1477-1478], ne≈æ tento obsah v p≈ô√≠≈°t√≠ f√°zi zp≈ô√≠stupn√≠me ve≈ôejnosti.

Tato f√°ze se zamƒõ≈ôuje na vytvo≈ôen√≠ datov√© struktury (M:N vztah), rozhran√≠ pro spr√°vu sb√≠rek a mechanismus pro p≈ôi≈ôazov√°n√≠ vide√≠ do sb√≠rek.

### 3\. Rozsah pro F√°zi 7

  * [cite\_start]**Datab√°ze (Prisma):** Roz≈°√≠≈ôen√≠ sch√©matu o model `Collection` a vytvo≈ôen√≠ **vztahu Many-to-Many** (M:N) mezi modely `Video` a `Collection` [cite: 1484-1485].
  * [cite\_start]**Architektura (RBAC):** Nov√Ω model `Collection` bude m√≠t vlastn√≠ka (`authorId`) a bude plnƒõ integrov√°n do st√°vaj√≠c√≠ logiky opr√°vnƒõn√≠ `isOwner || isAdmin` [cite: 1391-1393].
  * [cite\_start]**Viditelnost:** Model `Collection` bude obsahovat p≈ô√≠znak `isPublic` (Boolean), kter√Ω urƒç√≠ budouc√≠ viditelnost pro ve≈ôejnost[cite: 1478, 1485].
  * **API (Nov√©):** Vytvo≈ôen√≠ nov√Ωch API endpoint≈Ø pro plnou spr√°vu (CRUD) sb√≠rek (nap≈ô. `/api/collections`).
  * **API (√öprava):** Roz≈°√≠≈ôen√≠ st√°vaj√≠c√≠ho `PUT` endpointu pro editaci videa (`/api/videos/[id]`) tak, aby umƒõl aktualizovat p≈ôi≈ôazen√≠ videa do sb√≠rek.
  * **Frontend (Nov√©):** Vytvo≈ôen√≠ nov√© str√°nky ve spr√°vƒõ (nap≈ô. `/admin/collections`) pro vytv√°≈ôen√≠, editaci a maz√°n√≠ sb√≠rek.
  * [cite\_start]**Frontend (√öprava):** √öprava st√°vaj√≠c√≠ str√°nky "Editace Videa" (`/admin/edit/[id]`) [cite: 1315] o novou sekci, kter√° umo≈æn√≠ za≈°krtnut√≠m p≈ôi≈ôadit video do jedn√© nebo v√≠ce sb√≠rek.

**Mimo rozsah t√©to f√°ze:** Zve≈ôejnƒõn√≠ sb√≠rek pro ve≈ôejnost (to bude F√°ze 8), povy≈°ov√°n√≠ rol√≠ `USER` na `KURATOR` (to bude F√°ze 9).

-----

### 4\. üèõÔ∏è N√°vrh ≈òe≈°en√≠ a Architektura

Toto ≈ôe≈°en√≠ je navr≈æeno pro maxim√°ln√≠ ≈°k√°lovatelnost.

#### 4.1. Datab√°zov√Ω Model (Prisma)

Soubor `prisma/schema.prisma` bude upraven tak, aby obsahoval nov√Ω model a M:N vztah.

```prisma
// V existuj√≠c√≠m modelu User
model User {
  // ... st√°vaj√≠c√≠ pole
  videos       Video[]      // Videa vytvo≈ôen√° u≈æivatelem
  collections  Collection[] // Sb√≠rky vytvo≈ôen√© u≈æivatelem
}

// V existuj√≠c√≠m modelu Video
model Video {
  // ... st√°vaj√≠c√≠ pole (id, youtubeId, title, authorId, atd.)
  chapters    Chapter[]
  
  // --- NOV√Å RELACE (M:N) ---
  collections Collection[] 
}

// --- NOV√ù MODEL COLLECTION ---
model Collection {
  id          String   @id @default(cuid())
  name        String   // N√°zev sb√≠rky (nap≈ô. "Studie o mikrobiomu")
  description String?  @db.Text // Voliteln√Ω popis sb√≠rky
  
  // Vlastnictv√≠ (Pro RBAC)
  author      User     @relation(fields: [authorId], references: [id])
  [cite_start]authorId    String   // Kdo sb√≠rku vytvo≈ôil (ADMIN nebo KURATOR) [cite: 1485]

  // Ve≈ôejnost (Pro F√°zi 8)
  [cite_start]isPublic    Boolean  @default(false) // Uvid√≠ ji ve≈ôejnost? [cite: 1478, 1485]

  // Vztah (M:N)
  videos      Video[]  // Videa obsa≈æen√° v t√©to sb√≠rce

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
```

*Po t√©to zmƒõnƒõ bude nutn√© spustit migraci:* `npm run prisma:migrate -- --name "add_collection_model"`

#### 4.2. API vrstva (Backend)

**A. Nov√© API pro spr√°vu sb√≠rek (`app/api/collections/route.ts`)**

  * **POST:** Vytvo≈ô√≠ novou sb√≠rku. Mus√≠ ovƒõ≈ôit, ≈æe u≈æivatel je p≈ôihl√°≈°en (alespo≈à `USER`, i kdy≈æ teƒè to bude jen `ADMIN`) a automaticky nastavit `authorId` na `session.user.id`.
  * **GET:** Vr√°t√≠ seznam sb√≠rek. Bude respektovat RBAC:
      * `ADMIN` uvid√≠ *v≈°echny* sb√≠rky.
      * `KURATOR` (v budoucnu) uvid√≠ *jen sv√©* sb√≠rky.

**B. Nov√© API pro spr√°vu sb√≠rek (`app/api/collections/[id]/route.ts`)**

  * **PUT:** Umo≈æn√≠ upravit n√°zev, popis a p≈ô√≠znak `isPublic` dan√© sb√≠rky. Endpoint mus√≠ ovƒõ≈ôit opr√°vnƒõn√≠ (`isOwner || isAdmin`).
  * **DELETE:** Sma≈æe sb√≠rku. Endpoint mus√≠ ovƒõ≈ôit opr√°vnƒõn√≠ (`isOwner || isAdmin`). (Pozn√°mka: Smaz√°n√≠ sb√≠rky nesma≈æe videa v n√≠, pouze sma≈æe propojen√≠ ve vztahov√© tabulce).

**C. √öprava st√°vaj√≠c√≠ho API (`app/api/videos/[id]/route.ts`)**

  * Handler `PUT` (kter√Ω slou≈æ√≠ k editaci videa) bude roz≈°√≠≈ôen.
  * Kromƒõ `title`, `summary` atd. p≈ôijme nov√© pole: `collectionIds: string[]`.
  * [cite\_start]V r√°mci datab√°zov√© transakce (`prisma.$transaction`) [cite: 1405] provede `await tx.video.update(...)`, kde pou≈æije oper√°tor `set` pro M:N relaci:
    ```javascript
    await tx.video.update({
        where: { id: videoId },
        data: {
            title: body.title,
            // ... ostatn√≠ pole
            collections: {
                set: body.collectionIds.map((id: string) => ({ id: id }))
            }
        }
    });
    ```

#### 4.3. U≈æivatelsk√© Rozhran√≠ (Frontend)

**A. Nov√° str√°nka spr√°vce (`app/admin/collections/page.tsx`)**

  * Bude obsahovat jednoduch√Ω formul√°≈ô pro vytvo≈ôen√≠ nov√© sb√≠rky (pole `name`, `description`).
  * Pod formul√°≈ôem bude seznam (tabulka) v≈°ech sb√≠rek, kter√© u≈æivatel vid√≠ (dle logiky `GET /api/collections`).
  * Tabulka umo≈æn√≠ editaci (zmƒõna n√°zvu, `isPublic` p≈ôep√≠naƒç) a maz√°n√≠.

**B. √öprava str√°nky editace videa (`app/admin/edit/[id]/page.tsx`)**

  * [cite\_start]Tato str√°nka (vytvo≈ôen√° ve F√°zi 6) [cite: 1379] bude roz≈°√≠≈ôena.
  * P≈ôi naƒç√≠t√°n√≠ dat videa (`GET /api/videos/[id]`) mus√≠ tak√© naƒç√≠st seznam *v≈°ech* dostupn√Ωch sb√≠rek (`GET /api/collections`).
  * Ve formul√°≈ôi bude nov√° sekce "Za≈ôadit do sb√≠rek".
  * Zde se zobraz√≠ seznam v≈°ech sb√≠rek (nap≈ô. jako `checkbox`y). Ty, ve kter√Ωch video ji≈æ je, budou za≈°krtnut√©.
  * P≈ôi ulo≈æen√≠ (vol√°n√≠ `PUT /api/videos/[id]`) se pole ID za≈°krtnut√Ωch sb√≠rek ode≈°le v `collectionIds`.

-----

### 5\. üö¶ Funkƒçn√≠ Po≈æadavky (FR)

  * **FR1 (Vytvo≈ôen√≠ sb√≠rky):** Admin mus√≠ b√Ωt schopen vytvo≈ôit novou sb√≠rku s n√°zvem a popisem.
  * **FR2 (Spr√°va sb√≠rky):** Admin mus√≠ b√Ωt schopen upravit n√°zev, popis a stav (`isPublic`) sb√≠rky.
  * **FR3 (Maz√°n√≠ sb√≠rky):** Admin mus√≠ b√Ωt schopen smazat sb√≠rku (videa v n√≠ z≈Østanou zachov√°na, jen nebudou p≈ôi≈ôazena).
  * **FR4 (P≈ôi≈ôazen√≠ videa):** Admin mus√≠ m√≠t mo≈ænost na str√°nce editace videa za≈°krtnout, ve kter√Ωch sb√≠rk(√°ch) m√° video b√Ωt.
  * **FR5 (Ulo≈æen√≠ p≈ôi≈ôazen√≠):** Po ulo≈æen√≠ editace videa se mus√≠ M:N vztahy v datab√°zi korektnƒõ aktualizovat.

### 6\. üîí Nefunkƒçn√≠ Po≈æadavky (NFR)

  * [cite\_start]**NFR1 (Bezpeƒçnost RBAC):** V≈°echny nov√© API endpointy pro sb√≠rky mus√≠ striktnƒõ vynucovat vlastnictv√≠ (`isOwner || isAdmin`) na serveru [cite: 1391-1393].
  * **NFR2 (Datov√° Konzistence):** √öprava videa a jeho p≈ôi≈ôazen√≠ ke sb√≠rk√°m mus√≠ probƒõhnout v r√°mci jedn√© datab√°zov√© transakce (jak je pops√°no v 4.2.C).
  * **NFR3 (Integrita dat):** Datab√°zov√© sch√©ma mus√≠ pou≈æ√≠vat M:N vztah s relaƒçn√≠ tabulkou (Prisma to ≈ôe≈°√≠ automaticky), aby byla zaji≈°tƒõna integrita.

### 7\. üíª Technologick√Ω Stack a N√°stroje

  * [cite\_start]Vyu≈æ√≠v√° se st√°vaj√≠c√≠ stack: Next.js (App Router) [cite: 1173][cite\_start], Prisma [cite: 1181][cite\_start], NextAuth.js [cite: 1181][cite\_start], Vercel Postgres[cite: 1180].
  * Nejsou pot≈ôeba ≈æ√°dn√© nov√© kl√≠ƒçov√© knihovny.

-----

### 8\. ‚úÖ Akceptaƒçn√≠ Kriteria (Definice "Hotovo")

Tato f√°ze je dokonƒçena, kdy≈æ:

1.  Byla spu≈°tƒõna datab√°zov√° migrace pro model `Collection` (lok√°lnƒõ i na produkci).
2.  Admin se p≈ôihl√°s√≠, p≈ôejde na novou str√°nku `/admin/collections` a √∫spƒõ≈°nƒõ vytvo≈ô√≠ sb√≠rku "Testovac√≠ Sb√≠rka".
3.  Admin p≈ôejde na `/admin/edit/[id]` existuj√≠c√≠ho videa.
4.  Ve formul√°≈ôi vid√≠ novou sekci a v n√≠ "Testovac√≠ Sb√≠rka" (jako checkbox).
5.  Admin za≈°krtne "Testovac√≠ Sb√≠rka" a ulo≈æ√≠ video.
6.  V datab√°zi (ovƒõ≈ôeno nap≈ô. p≈ôes `npm run prisma:studio`) existuje propojen√≠ mezi videem a sb√≠rkou ve vztahov√© tabulce `_CollectionToVideo`.
7.  Admin m≈Ø≈æe na str√°nce `/admin/collections` zmƒõnit n√°zev sb√≠rky nebo jej√≠ p≈ô√≠znak `isPublic`.

### 9\. üöÄ Budouc√≠ Rozvoj (Mimo Rozsah T√©to F√°ze)

  * **F√°ze 8:** Zve≈ôejnƒõn√≠ obsahu. Vytvo≈ôen√≠ ve≈ôejn√Ωch str√°nek (`/` a `/collections/[id]`), kter√© budou ƒç√≠st data a zobrazovat sb√≠rky a videa na z√°kladƒõ p≈ô√≠znaku `isPublic: true`.
  * **F√°ze 9:** Pov√Ω≈°en√≠ rol√≠. Implementace logiky, kdy `ADMIN` m≈Ø≈æe zmƒõnit roli `USER` na `KURATOR`, ƒç√≠m≈æ mu odemkne p≈ô√≠stup ke spr√°vƒõ vlastn√≠ho obsahu.

id_chat: 
https://gemini.google.com/u/1/app/26e898a8e59b64ef


