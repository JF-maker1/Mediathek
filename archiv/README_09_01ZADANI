TestovÃ¡nÃ­ probÄ›hlo ok ale v rÃ¡mci tohoto releasu mÃ¡m jeÅ¡tÄ› nÄ›kolik nÃ¡padu k designu jednotlivÃ½ch strÃ¡nek (napÅ™. Ãºprava barvy pÃ­sma) kterÃ© by jsme mohli vyÅ™eÅ¡it pÅ™ed vytvoÅ™enÃ­m veÅ™ejnÃ© strÃ¡nky. JednÃ¡ se o tyto nÃ¡pady na design strÃ¡nek: - Ãºprava zobrazenÃ­ pole s videem resp. jeho redesign nynÃ­ je zobrazeno toto pole mÅ™Ã­Å¾ky s tÃ­mto obsahem [ obrÃ¡zek videa z youtube

Krank durch Milchprodukte Welche 6 sind die ÃœbeltÃ¤ter und welche wirken heilend ?

ID: mC_JUnlqALw

Autor: florianjiri@gmail.com

Milchprodukte stehen immer wieder in der Kritik â€“ doch nicht alle sind gleich! In diesem Video erfÃ¤hrst du, welche 6 Milchprodukte deiner Gesundheit ernsthaft schaden kÃ¶nnen, und welche 5 tatsÃ¤chlich heilende Wirkungen auf Darm, Knochen und EntzÃ¼ndungen haben. Besonders fÃ¼r Menschen mit Hautproblemen, Gelenkschmerzen oder Verdauungsbeschwerden kann dieses Wissen den Unterschied machen!13. 11. 2025

] - jde o redesign tak aby bylo jasnÄ› oddÄ›lenÃ© Å¾e se jednÃ¡ o "kartu videa"


JÃ_PROMPT:
V pÅ™Ã­loze jsou dokumenty popisujÃ­cÃ­ dosavadnÃ­ vÃ½voj webovÃ© aplikace po strÃ¡nce jednotlivÃ½ch vÃ½vojovÃ½ch cyklÅ¯ tÃ©to webovÃ© aplikace z hlediska vÃ½voje jejÃ­ho zadÃ¡nÃ­ i realizace. Dokumenty popisujÃ­ jejÃ­ vÃ½voj od poÄÃ¡tku resp. kick off aÅ¾ po poslednÃ­ vÃ½vojovÃ½ cyklus, kterÃ©mu se dokumenty vÄ›nujÃ­ nejpodrobnÄ›ji - zejmÃ©na pak dokument [README_07_02REALIZACE], kterÃ½ je zÃ¡znamem o implementaci poslednÃ­ho vÃ½vojovÃ©ho cyklu, kterÃ½ se vÄ›noval implementaci funkcionality sbÃ­rek, resp. moÅ¾nosti uspoÅ™Ã¡dÃ¡vat elementÃ¡rnÃ­ poloÅ¾ky tÃ©to webovÃ© aplikace resp. videa z youtube do sbÃ­rek. Tyto sbÃ­rky pak majÃ­ implementovÃ¡ny vlastnosti komu patÅ™Ã­ a zda jsou veÅ™ejnÃ© nebo soukromÃ©. Tyto vlastnosti z hlediska vlastnictvÃ­ a veÅ™ejnosti poloÅ¾ky by mÄ›ly bÃ½t implementovÃ¡ny zatÃ­m pouze na Ãºrovni sbÃ­rek. Aplikace je ve fÃ¡zi kdy by jsme mÄ›li vytvÃ¡Å™et funkcionalitu uveÅ™ejÅˆovÃ¡nÃ­ obsahu sbÃ­rek uÅ¾ivatelÅ¯m aplikace resp. nÃ¡vÅ¡tÄ›vnÃ­kÅ¯m tÃ©to webovÃ© aplikace. V souÄasnÃ© dobÄ› k nÃ¡hledu a prohlÃ­Å¾enÃ­ obsahu vloÅ¾enÃ½ch videÃ­ a jejich pÅ™ehrÃ¡vÃ¡nÃ­ slouÅ¾Ã­ strÃ¡nka '"PÅ™ehled obsahu". NynÃ­ bychom mÄ›li umoÅ¾nit jakÃ©mukoliv nÃ¡vÅ¡tÄ›vnÃ­kovi webovÃ½ch strÃ¡nek (resp. od nejniÅ¾Å¡Ã­ho prÃ¡va VISITOR (resp. anonymous) - dalÅ¡Ã­ prÃ¡vo je USER (jiÅ¾ implementovÃ¡no), pak KURATOR(nenÃ­ zatÃ­m implementovÃ¡no), pak ADMIN (jÃ¡) ) prohlÃ­Å¾et tuto strÃ¡nku '"PÅ™ehled obsahu" s tÃ­m Å¾e vÅ¡ichni kdo majÃ­ prÃ¡va na VISITOR a vyÅ¡Å¡Ã­ jÃ­ mohou navÅ¡tÃ­vit a uvidÃ­ vÅ¡echny poloÅ¾ky kterÃ© nejsou ve sbÃ­rce kterÃ¡ je soukromÃ¡ resp. poloÅ¾ky kterÃ© jsou ve sbÃ­rce "soukromÃ¡" uvidÃ­ jen vlastnÃ­k/resp. vlastnÃ­ci(do budoucna je moÅ¾nÃ© uvaÅ¾ovat o tom Å¾e vlastnÃ­ky jednÃ© sbÃ­rky bude vÃ­ce uÅ¾ivatelÅ¯ a budou moci spoleÄnÄ› upravovat tuto sbÃ­rku) tÃ©to soukromÃ© sbÃ­rky. Toto by mÄ›lo bÃ½t zadÃ¡nÃ­ tohoto vÃ½vojovÃ©ho cyklu, ke kterÃ©mu bychom nynÃ­ vytvoÅ™ili robustnÃ­ zadÃ¡nÃ­ a implementaci navazujÃ­cÃ­ na jiÅ¾ pÅ™ipravenÃ© podmÃ­nky k tomuto v aplikaci (je diskutovÃ¡no prÃ¡vÄ› v pÅ™Ã­loÅ¾enÃ½ch dokumentech z vÃ½voje aplikace) Pojdme nynÃ­ na zÃ¡kladÄ› pÅ™edeÅ¡lÃ©ho vÃ½voje aplikace vytvoÅ™it zadÃ¡nÃ­ k uplatÅˆovÃ¡nÃ­ prÃ¡v pro prohlÃ­Å¾enÃ­ obsahu aplikace resp. moÅ¾nosti vidÄ›t strÃ¡nku "PÅ™ehled obsahu" a konkrÃ©tnÃ­ jejÃ­ poloÅ¾ky dle prÃ¡v s kterÃ½mi na strÃ¡nku vstupuje uÅ¾ivatel. ProsÃ­m o pÅ™Ã­padnÃ© nÃ¡vrhy kterÃ© patÅ™Ã­Ã­k best praxis ohlednÄ› uÅ¾ivatelskÃ½ch prÃ¡v uplatÅˆovanÃ½ch na webovÃ½ch aplikacÃ­ch. DÃ­ky. ;-)
[README_07_01ZADANI_SOUHRN_ZADANI_REALIZACE]

AI_RESPONZE:

Ano, naprosto. Jsme v klÃ­ÄovÃ©m bodÄ› projektu. MÃ¡me hotovou "strojovnu" (FÃ¡ze 1-7) a nynÃ­ je Äas otevÅ™Ã­t prvnÃ­ "vÃ½lohu".

VaÅ¡e zadÃ¡nÃ­ je pÅ™esnÃ©. MusÃ­me vzÃ­t stÃ¡vajÃ­cÃ­ strÃ¡nku "PÅ™ehled obsahu" (technicky app/admin/dashboard/page.tsx) a vytvoÅ™it jejÃ­ veÅ™ejnou verzi, kterÃ¡ bude inteligentnÄ› filtrovat obsah na zÃ¡kladÄ› prÃ¡v nÃ¡vÅ¡tÄ›vnÃ­ka.

PojÄme si rozebrat vaÅ¡i specifikaci a "best practices" a sestavit z toho robustnÃ­ zadÃ¡nÃ­.

ğŸ’¡ KlÃ­ÄovÃ© "Best Practices" a NÃ¡vrhy
VÃ¡Å¡ nÃ¡vrh na filtrovÃ¡nÃ­ je sprÃ¡vnÃ½, ale skrÃ½vÃ¡ v sobÄ› jednu implementaÄnÃ­ sloÅ¾itost.

VÃ¡Å¡ nÃ¡vrh: "uvidÃ­ vÅ¡echny poloÅ¾ky kterÃ© nejsou ve sbÃ­rce kterÃ¡ je soukromÃ¡".

ProblÃ©m: Co kdyÅ¾ video nenÃ­ v Å¾Ã¡dnÃ© sbÃ­rce? Nebo je zÃ¡roveÅˆ ve veÅ™ejnÃ© i soukromÃ© sbÃ­rce?

RobustnÃ­ "Best Practice" Å™eÅ¡enÃ­:

MusÃ­me otoÄit logiku. MÃ­sto "blacklistingu" (skrÃ½vÃ¡nÃ­ soukromÃ½ch) pouÅ¾ijeme "whitelisting" (explicitnÃ­ zobrazovÃ¡nÃ­ veÅ™ejnÃ½ch).

Pravidlo 1: Video je veÅ™ejnÃ©, pokud je zaÅ™azeno v alespoÅˆ jednÃ© veÅ™ejnÃ© sbÃ­rce (kterÃ¡ mÃ¡ isPublic: true).

Pravidlo 2: Pokud video nenÃ­ v Å¾Ã¡dnÃ© sbÃ­rce nebo je pouze v soukromÃ½ch sbÃ­rkÃ¡ch, je pro veÅ™ejnost neviditelnÃ©. TÃ­m jsou automaticky "drafty" (nezaÅ™azenÃ¡ videa) skrytÃ©.

DÃ¡le, z hlediska "best practice" a bezpeÄnosti nebudeme "otevÃ­rat" stÃ¡vajÃ­cÃ­ strÃ¡nku /admin/dashboard. Cokoliv pod /admin musÃ­ zÅ¯stat 100% chrÃ¡nÄ›no. MÃ­sto toho vytvoÅ™Ã­me novou, veÅ™ejnou domovskou strÃ¡nku (app/page.tsx), kterÃ¡ znovu pouÅ¾ije vizuÃ¡lnÃ­ komponenty z dashboardu, ale bude mÃ­t vlastnÃ­, chytrou logiku naÄÃ­tÃ¡nÃ­ dat.

ğŸš€ NÃ¡Å¡ CÃ­l: DynamickÃ¡ DomovskÃ¡ StrÃ¡nka (RSC)
VytvoÅ™Ã­me jednu strÃ¡nku (app/page.tsx), kterÃ¡ na serveru zjistÃ­, kdo se dÃ­vÃ¡, a podle toho sestavÃ­ dotaz do databÃ¡ze.

Server se podÃ­vÃ¡: "MÃ¡m session?"

ScÃ©nÃ¡Å™ A: VISITOR (Anonym): Session nenÃ­. Server poÅ¡le dotaz: "VraÅ¥ mi vÅ¡echna videa, kterÃ¡ patÅ™Ã­ do sbÃ­rky s isPublic: true."

ScÃ©nÃ¡Å™ B: USER: Session je (role USER). Server poÅ¡le stejnÃ½ dotaz jako pro Anonyma. (Pro roli USER se zatÃ­m nic nemÄ›nÃ­).

ScÃ©nÃ¡Å™ C: ADMIN: Session je (role ADMIN). Server poÅ¡le dotaz: "VraÅ¥ mi vÅ¡echna videa bez filtru."

ScÃ©nÃ¡Å™ D (BudoucÃ­): KURATOR: Session je (role KURATOR). Server poÅ¡le dotaz: "VraÅ¥ mi vÅ¡echna isPublic: true videa NEBO videa, kde authorId je moje."

Toto je extrÃ©mnÄ› robustnÃ­ a bezpeÄnÃ½ model. Logika oprÃ¡vnÄ›nÃ­ se nikdy nedostane na klienta.

Zde je finÃ¡lnÃ­, robustnÃ­ zadÃ¡nÃ­ pro FÃ¡zi 8, kterÃ© toto vÅ¡e reflektuje.

ğŸ“„ ZadÃ¡nÃ­ projektu: WebovÃ¡ aplikace Mediathek (FÃ¡ze 8 - ZveÅ™ejnÄ›nÃ­ obsahu)
Datum: 17. listopadu 2025 Verze: 8.0


Navazuje na: FÃ¡ze 7 (Implementace SbÃ­rek )



1. NÃ¡zev projektu
Mediathek

2. ğŸ¯ CÃ­l FÃ¡ze
PrimÃ¡rnÃ­m cÃ­lem tÃ©to fÃ¡ze je zpÅ™Ã­stupnit obsah aplikace veÅ™ejnosti. VytvoÅ™Ã­me novou domovskou strÃ¡nku (/), kterÃ¡ bude slouÅ¾it jako veÅ™ejnÃ½ "PÅ™ehled obsahu". Tato strÃ¡nka bude implementovÃ¡na jako React Server Component (RSC) a bude inteligentnÄ› filtrovat zobrazenÃ¡ videa na zÃ¡kladÄ› role a oprÃ¡vnÄ›nÃ­ uÅ¾ivatele (od VISITORa po ADMINa), pÅ™iÄemÅ¾ veÅ¡kerÃ¡ logika oprÃ¡vnÄ›nÃ­ zÅ¯stane bezpeÄnÄ› na serveru.

3. Rozsah pro FÃ¡zi 8
Architektura (NovÃ©): VytvoÅ™enÃ­ novÃ© hlavnÃ­ strÃ¡nky app/page.tsx jako (RSC).

Architektura (Ãšprava): Ãšprava middleware.ts tak, aby byla domovskÃ¡ strÃ¡nka (/) veÅ™ejnÄ› pÅ™Ã­stupnÃ¡ a nevyÅ¾adovala pÅ™ihlÃ¡Å¡enÃ­.

Backend (Data Fetching): Implementace server-side logiky v app/page.tsx, kterÃ¡ naÄte session a na zÃ¡kladÄ› role sestavÃ­ dynamickÃ½ Prisma dotaz pro filtrovÃ¡nÃ­ videÃ­.

Frontend (Re-use): Znovu-pouÅ¾itÃ­ stÃ¡vajÃ­cÃ­ch vizuÃ¡lnÃ­ch komponent (napÅ™. mÅ™Ã­Å¾ka, karty videÃ­) ze strÃ¡nky app/admin/dashboard/page.tsx pro zobrazenÃ­ obsahu na novÃ© domovskÃ© strÃ¡nce.

Navigace: Ãšprava components/Navbar.tsx tak, aby logo nebo nÃ¡zev "Mediathek" vÅ¾dy smÄ›Å™oval na /.

Mimo rozsah tÃ©to fÃ¡ze:

Implementace povyÅ¡ovÃ¡nÃ­ rolÃ­ (USER -> KURATOR). To bude FÃ¡ze 9.

VeÅ™ejnÃ¡ strÃ¡nka detailu videa (/video/[id]). Ta bude nÃ¡sledovat aÅ¾ po tÃ©to fÃ¡zi.

VeÅ™ejnÃ¡ strÃ¡nka detailu sbÃ­rky (/collections/[id]).

4. ğŸ›ï¸ NÃ¡vrh Å˜eÅ¡enÃ­ a Architektura ("Best Practices")
Toto Å™eÅ¡enÃ­ je navrÅ¾eno s dÅ¯razem na bezpeÄnost (Server-Side filtering) a znovupouÅ¾itelnost.

4.1. ArchitektonickÃ© RozhodnutÃ­ (VeÅ™ejnÃ¡ vs. Admin)
Nebudeme zpÅ™Ã­stupÅˆovat app/admin/dashboard. Z bezpeÄnostnÃ­ch dÅ¯vodÅ¯ musÃ­ celÃ¡ sekce /admin zÅ¯stat chrÃ¡nÄ›nÃ¡. MÃ­sto toho vytvoÅ™Ã­me novou, veÅ™ejnou domovskou strÃ¡nku app/page.tsx, kterÃ¡ bude slouÅ¾it jako hlavnÃ­ "vÃ½loha" (vÃ¡Å¡ "PÅ™ehled obsahu").

4.2. Konfigurace ZabezpeÄenÃ­ (Middleware)
Soubor middleware.ts musÃ­ bÃ½t upraven tak, aby chrÃ¡nil vÅ¡e kromÄ› domovskÃ© strÃ¡nky.

StÃ¡vajÃ­cÃ­ matcher pravdÄ›podobnÄ› vypadÃ¡ takto: matcher: ['/admin/:path*'].

MusÃ­me zajistit, aby matcher nezahrnoval /. Pokud nÃ¡hodou chrÃ¡nÃ­te /, musÃ­me to zmÄ›nit.

CÃ­lovÃ½ stav: KoÅ™enovÃ¡ strÃ¡nka / musÃ­ bÃ½t pÅ™Ã­stupnÃ¡ bez pÅ™ihlÃ¡Å¡enÃ­.

4.3. Logika OprÃ¡vnÄ›nÃ­ (DynamickÃ© NaÄÃ­tÃ¡nÃ­ Dat v app/page.tsx)
Toto je jÃ¡dro celÃ© fÃ¡ze. VeÅ¡kerÃ¡ logika probÄ›hne na serveru uvnitÅ™ RSC.

TypeScript

// app/page.tsx

import { getServerSession } from 'next-auth/next';
import { authOptions } from '@/app/api/auth/[...nextauth]/route';
import { PrismaClient, Prisma } from '@prisma/client';
// Import komponenty pro zobrazenÃ­ mÅ™Ã­Å¾ky (napÅ™. z /admin/dashboard)
// import { VideoGrid } from '@/components/VideoGrid'; 

const prisma = new PrismaClient();

export default async function HomePage() {
  const session = await getServerSession(authOptions);
  
  // 1. SestavenÃ­ dynamickÃ©ho 'where' dotazu
  let whereClause: Prisma.VideoWhereInput = {
    // ---- BEST PRACTICE LOGIKA ----
    // Ve vÃ½chozÃ­m stavu (pro VISITORa) chceme videa,
    // kterÃ¡ jsou v ALESPOÅ‡ JEDNÃ‰ veÅ™ejnÃ© sbÃ­rce.
    collections: {
      some: {
        isPublic: true
      }
    }
  };

  // 2. RozÅ¡Ã­Å™enÃ­ logiky pro pÅ™ihlÃ¡Å¡enÃ© role
  if (session) {
    if (session.user.role === 'ADMIN') {
      // ADMIN vidÃ­ VÅ ECHNO (vÄetnÄ› nezaÅ™azenÃ½ch a soukromÃ½ch)
      whereClause = {}; 
    }
    
    // TODO: PÅ™ipravit pro FÃ¡zi 9 (KURATOR)
    // if (session.user.role === 'KURATOR') {
    //   // KURATOR vidÃ­ VÅ ECHNY VEÅ˜EJNÃ‰ + VÅ ECHNY SVÃ‰ SOUKROMÃ‰
    //   whereClause = {
    //     OR: [
    //       { collections: { some: { isPublic: true } } },
    //       { authorId: session.user.id }
    //     ]
    //   };
    // }

    // Pro roli 'USER' platÃ­ stejnÃ¡ logika jako pro 'VISITOR'a
  }

  // 3. FinÃ¡lnÃ­ dotaz do DB
  const videos = await prisma.video.findMany({
    where: whereClause,
    include: {
      author: { select: { name: true } }, // PÅ™Ã­klad
    },
    orderBy: { createdAt: 'desc' }
  });

  // 4. ZobrazenÃ­
  return (
    <div>
      <h1 className="text-3xl font-bold mb-6">PÅ™ehled obsahu</h1>
      {/* Zde znovu pouÅ¾ijeme komponentu mÅ™Ã­Å¾ky, napÅ™.: */}
      {/* <VideoGrid videos={videos} /> */}
      <p>(Zde bude mÅ™Ã­Å¾ka videÃ­... PoÄet naÄtenÃ½ch: {videos.length})</p>
    </div>
  );
}
5. ğŸš¦ FunkÄnÃ­ PoÅ¾adavky (FR)
FR1 (VISITOR): NÃ¡vÅ¡tÄ›vnÃ­k, kterÃ½ nenÃ­ pÅ™ihlÃ¡Å¡en (AnonymnÃ­), musÃ­ na domovskÃ© strÃ¡nce (/) vidÄ›t pouze videa, kterÃ¡ jsou zaÅ™azena v alespoÅˆ jednÃ© sbÃ­rce oznaÄenÃ© jako isPublic: true.

FR2 (USER): UÅ¾ivatel s rolÃ­ USER musÃ­ na domovskÃ© strÃ¡nce vidÄ›t totÃ©Å¾ co VISITOR.

FR3 (ADMIN): UÅ¾ivatel s rolÃ­ ADMIN musÃ­ na domovskÃ© strÃ¡nce vidÄ›t vÅ¡echna videa v databÃ¡zi (veÅ™ejnÃ¡, soukromÃ¡, i nezaÅ™azenÃ¡).

FR4 (SkrytÃ­ nezaÅ™azenÃ½ch): Video, kterÃ© nenÃ­ v Å¾Ã¡dnÃ© sbÃ­rce, nesmÃ­ bÃ½t viditelnÃ© pro VISITORa ani USERa (musÃ­ bÃ½t viditelnÃ© pro ADMINa).

FR5 (SkrytÃ­ soukromÃ½ch): Video, kterÃ© je pouze v soukromÃ½ch sbÃ­rkÃ¡ch (isPublic: false), nesmÃ­ bÃ½t viditelnÃ© pro VISITORa ani USERa.

6. ğŸ”’ NefunkÄnÃ­ PoÅ¾adavky (NFR)
NFR1 (BezpeÄnost): VeÅ¡kerÃ¡ filtrace obsahu na zÃ¡kladÄ› oprÃ¡vnÄ›nÃ­ musÃ­ probÃ­hat vÃ½hradnÄ› na serveru (v RSC / Prisma dotazu). Klientovi se nikdy nesmÃ­ poslat data, kterÃ¡ by nemÄ›l vidÄ›t.

NFR2 (VÃ½kon): StrÃ¡nka / musÃ­ bÃ½t (jako RSC) rychlÃ¡ a optimalizovanÃ¡ pro SEO.

NFR3 (Konzistence): VizuÃ¡lnÃ­ zobrazenÃ­ "PÅ™ehledu obsahu" na / by mÄ›lo co nejvÃ­ce (pokud je to vhodnÃ©) znovu pouÅ¾Ã­t komponenty z app/admin/dashboard/page.tsx pro konzistentnÃ­ vzhled.

7. ğŸ’» TechnologickÃ½ Stack a NÃ¡stroje
VyuÅ¾Ã­vÃ¡ se stÃ¡vajÃ­cÃ­ stack: Next.js (App Router), Prisma, NextAuth.js.

Nejsou potÅ™eba Å¾Ã¡dnÃ© novÃ© knihovny.

8. âœ… AkceptaÄnÃ­ Kriteria (Definice "Hotovo")
Tato fÃ¡ze je dokonÄena, kdyÅ¾:

Test 1 (VISITOR): Je otevÅ™eno anonymnÃ­ okno prohlÃ­Å¾eÄe, je navÅ¡tÃ­vena adresa /. ZobrazÃ­ se pouze videa ze sbÃ­rek s isPublic: true.

Test 2 (ADMIN): ADMIN se pÅ™ihlÃ¡sÃ­, navÅ¡tÃ­vÃ­ /. ZobrazÃ­ se vÅ¡echna videa.

Test 3 (ScÃ©nÃ¡Å™: Draft): ADMIN vytvoÅ™Ã­ novÃ© video, ale nepÅ™iÅ™adÃ­ ho do Å¾Ã¡dnÃ© sbÃ­rky.

ADMIN ho na / vidÃ­.

VISITOR (v anonymnÃ­m oknÄ›) ho na / nevidÃ­.

Test 4 (ScÃ©nÃ¡Å™: SoukromÃ©): ADMIN pÅ™iÅ™adÃ­ toto video pouze do soukromÃ© sbÃ­rky.

ADMIN ho na / vidÃ­.

VISITOR ho na / nevidÃ­.

Test 5 (ScÃ©nÃ¡Å™: VeÅ™ejnÃ©): ADMIN pÅ™iÅ™adÃ­ toto video do veÅ™ejnÃ© sbÃ­rky.

VISITOR ho na / vidÃ­.

9. ğŸš€ BudoucÃ­ Rozvoj (Mimo Rozsah TÃ©to FÃ¡ze)
FÃ¡ze 9: PovÃ½Å¡enÃ­ rolÃ­. Implementace logiky, kdy ADMIN mÅ¯Å¾e zmÄ›nit roli USER na KURATOR, ÄÃ­mÅ¾ se aktivuje pÅ™ipravenÃ¡ (ale nynÃ­ zakomentovanÃ¡) logika v app/page.tsx.

FÃ¡ze 10: VeÅ™ejnÃ½ detail videa. VytvoÅ™enÃ­ app/video/[id]/page.tsx, kterÃ¡ bude veÅ™ejnÄ› zobrazovat pÅ™ehrÃ¡vaÄ a strukturovanÃ½ obsah (a bude mÃ­t vlastnÃ­ kontrolu oprÃ¡vnÄ›nÃ­).
    
    
    
    
    
    
    

JÃ_PROMPT:
DÄ›kuji za zadÃ¡nÃ­ - zadÃ¡nÃ­ jsem si proÄetl a mÄ›l bych dotaz k tomuto bodu [VytvoÅ™Ã­me jednu strÃ¡nku (app/page.tsx), kterÃ¡ na serveru zjistÃ­, kdo se dÃ­vÃ¡, a podle toho sestavÃ­ dotaz do databÃ¡ze.

Server se podÃ­vÃ¡: "MÃ¡m session?"
ScÃ©nÃ¡Å™ A: VISITOR (Anonym): Session nenÃ­. Server poÅ¡le dotaz: "VraÅ¥ mi vÅ¡echna videa, kterÃ¡ patÅ™Ã­ do sbÃ­rky s isPublic: true."
ScÃ©nÃ¡Å™ B: USER: Session je (role USER). Server poÅ¡le stejnÃ½ dotaz jako pro Anonyma. (Pro roli USER se zatÃ­m nic nemÄ›nÃ­).
ScÃ©nÃ¡Å™ C: ADMIN: Session je (role ADMIN). Server poÅ¡le dotaz: "VraÅ¥ mi vÅ¡echna videa bez filtru."
ScÃ©nÃ¡Å™ D (BudoucÃ­): KURATOR: Session je (role KURATOR). Server poÅ¡le dotaz: "VraÅ¥ mi vÅ¡echna isPublic: true videa NEBO videa, kde authorId je moje."] - zda by jeÅ¡tÄ› robustnÄ›jÅ¡Ã­ nebylo jedinnÃ© pravidlo a to strÃ¡nky navÅ¡Ã­vil nÄ›kdo s rolÃ­ rovnou a vyÅ¡Å¡Ã­ VISITOR (Anonym) potom zobrazÃ­m [Server poÅ¡le dotaz: "VraÅ¥ mi vÅ¡echna videa, kterÃ¡ patÅ™Ã­ do sbÃ­rky s isPublic: true."]. k Äemu je potÅ™eba nebo co znamenÃ¡ [Server se podÃ­vÃ¡: "MÃ¡m session?"] ... potÅ™eboval bych toto asi trochu vysvÄ›tlit ;-)


AI_RESPONZE:

Je to skvÄ›lÃ¡ a velmi dÅ¯leÅ¾itÃ¡ otÃ¡zka, kterÃ¡ mÃ­Å™Ã­ pÅ™Ã­mo na jÃ¡dro robustnÃ­ architektury.

MÃ¡te naprostou pravdu, Å¾e pro vÄ›tÅ¡inu uÅ¾ivatelÅ¯ (pro VISITORa i USERa) platÃ­ to jedno pravidlo, kterÃ© navrhujete: "zobrazit jen isPublic: true videa."

Ta kontrola "MÃ¡m session?" je tam z jednoho zÃ¡sadnÃ­ho dÅ¯vodu: MusÃ­me odliÅ¡it vÃ½jimky â€“ role, kterÃ© majÃ­ vidÄ›t vÃ­c neÅ¾ jen veÅ™ejnÃ½ obsah.

PojÄme si to rozebrat.

1. ProÄ je kontrola "MÃ¡m session?" klÃ­ÄovÃ¡?
ProtoÅ¾e "VISITOR (Anonym)" nenÃ­ technicky "role". Je to stav, kdy uÅ¾ivatel nemÃ¡ session.

KdyÅ¾ server zkontroluje "MÃ¡m session?" a odpovÄ›Ä je NE (session je null), server vÃ­: "Aha, toto je VISITOR. NemÃ¡m tuÅ¡enÃ­, kdo to je. DÃ¡m mu jen veÅ™ejnÃ¡ (isPublic: true) videa."

KdyÅ¾ server zkontroluje "MÃ¡m session?" a odpovÄ›Ä je ANO (session existuje), server vÃ­: "OK, nÄ›kdo je pÅ™ihlÃ¡Å¡enÃ½. TeÄ se musÃ­m podÃ­vat, jakou mÃ¡ roli (session.user.role), abych vÄ›dÄ›l, jestli nemÃ¡ speciÃ¡lnÃ­ prÃ¡va."

2. VysvÄ›tlenÃ­ ScÃ©nÃ¡Å™Å¯ (ProÄ nestaÄÃ­ jedno pravidlo)
Zde je pÅ™esnÄ› vidÄ›t, proÄ potÅ™ebujeme tu kontrolu session:

ScÃ©nÃ¡Å™ A: VISITOR (Anonym)

"MÃ¡m session?" -> NE.

Server pouÅ¾ije zÃ¡kladnÃ­ pravidlo: ZobrazÃ­ jen isPublic: true.

Toto je vÃ¡Å¡ navrhovanÃ½ pÅ™Ã­pad.

ScÃ©nÃ¡Å™ B: USER

"MÃ¡m session?" -> ANO.

Server se podÃ­vÃ¡ na roli: session.user.role === 'USER'.

Server si Å™ekne: "Role USER nemÃ¡ speciÃ¡lnÃ­ prÃ¡va."

Server pouÅ¾ije zÃ¡kladnÃ­ pravidlo: ZobrazÃ­ jen isPublic: true.

I toto je vÃ¡Å¡ navrhovanÃ½ pÅ™Ã­pad.

ScÃ©nÃ¡Å™ C: ADMIN (Ta dÅ¯leÅ¾itÃ¡ VÃJIMKA)

"MÃ¡m session?" -> ANO.

Server se podÃ­vÃ¡ na roli: session.user.role === 'ADMIN'.

Server si Å™ekne: "POZOR! Toto je Admin. Pro nÄ›j zÃ¡kladnÃ­ pravidlo neplatÃ­!"

Server pouÅ¾ije speciÃ¡lnÃ­ pravidlo: ZobrazÃ­ vÅ¡echna videa (zruÅ¡Ã­ filtr isPublic).

ShrnutÃ­
Kdybychom pouÅ¾ili jen vaÅ¡e jedno pravidlo ("vÅ¾dy zobrazit jen isPublic: true"), stala by se velkÃ¡ chyba:

VÃ¡Å¡ ADMIN ÃºÄet by na hlavnÃ­ strÃ¡nce vidÄ›l jen veÅ™ejnÃ¡ videa. NevidÄ›l by svÃ¡ vlastnÃ­ "draft" videa, kterÃ¡ jeÅ¡tÄ› nezaÅ™adil nebo kterÃ¡ mÃ¡ ve svÃ© soukromÃ© sbÃ­rce "k analÃ½ze".

Proto je ta kontrola "MÃ¡m session?" naprosto zÃ¡sadnÃ­. Je to "rozcestnÃ­k", kterÃ½ Å™Ã­kÃ¡:

Jsi anonym? -> DostaneÅ¡ veÅ™ejnÃ½ obsah.

Jsi pÅ™ihlÃ¡Å¡enÃ½? -> PodÃ­vÃ¡m se, kdo jsi.

Jsi USER? -> DostaneÅ¡ veÅ™ejnÃ½ obsah.

Jsi ADMIN? -> DostaneÅ¡ vÅ¡echno.

Je to robustnÄ›jÅ¡Ã­ prÃ¡vÄ› proto, Å¾e to bezpeÄnÄ› na serveru zvlÃ¡dÃ¡ obslouÅ¾it jak standardnÃ­ nÃ¡vÅ¡tÄ›vnÃ­ky, tak privilegovanÃ© sprÃ¡vce pomocÃ­ jednÃ© jedinÃ© strÃ¡nky.





JÃ_PROMPT:
RozumÃ­m toto slouÅ¾Ã­ k nÃ¡hledu pro drafty - dalo by se Å™Ã­ci Å¾e potÃ© bude moÅ¾nÃ© zruÅ¡it strÃ¡nku [app/admin/dashboard/page.tsx] resp. souÄasnÃ½ "PÅ™ehled obsahu" resp. kurÃ¡toÅ™i a admin uvidÃ­ svÅ¯j obsah i na veÅ™ejnÃ© strÃ¡nce [app/page.tsx] ... nebo je vhodnÃ© nechat oboje strÃ¡nky protoÅ¾e jejich uÅ¾ivatelskÃ½ obsah se postupnÄ› rozejde resp. napÅ™. Å¾e veÅ™ejnÃ¡ strÃ¡nka bude mÃ­t trochu jinou strukturu neÅ¾ ta nynÃ­ administrÃ¡torskÃ¡ strÃ¡nka obsahu ... resp. jde mi o to aby nebyla v aplikaci duplikovÃ¡na shodnÃ¡ funkcionalita na vÃ­ce mÃ­stech a aplikace zÅ¯stala co nejvÃ­ce kompaktnÃ­ ...  


AI_RESPONZE:
To je naprosto excelentnÃ­ postÅ™eh a pÅ™esnÄ› ta sprÃ¡vnÃ¡ Ãºvaha, kterou by mÄ›l mÃ­t architekt systÃ©mu.

MÃ¡te pravdu v obou bodech:

Ano, hrozÃ­ tam duplicita funkÄnosti.

Ano, je velmi pravdÄ›podobnÃ©, Å¾e se jejich ÃºÄel rozejde.

Zde je "best practice" doporuÄenÃ­:

PonechÃ¡me obÄ› strÃ¡nky, protoÅ¾e majÃ­ odliÅ¡nÃ½ ÃºÄel a publikum.

Ta klÃ­ÄovÃ¡ myÅ¡lenka je "oddÄ›lenÃ­ odpovÄ›dnosti" (Separation of Concerns).

1. VeÅ™ejnÃ¡ strÃ¡nka (app/page.tsx) = "VÃ½loha" ğŸ›ï¸
Toto je vaÅ¡e prezentaÄnÃ­ rozhranÃ­.

ÃšÄel: PÅ™ilÃ¡kat a obslouÅ¾it VISITORy a USERy.

BudoucÃ­ vÃ½voj: Je tÃ©mÄ›Å™ jistÃ©, Å¾e tato strÃ¡nka se zmÄ›nÃ­. MoÅ¾nÃ¡ za mÄ›sÃ­c zjistÃ­te, Å¾e nechcete zobrazovat jen "videa", ale chcete zobrazovat primÃ¡rnÄ› kolekce (jako Netflix â€“ Å™Ã¡dky pro "NovÃ© recepty", "PopulÃ¡rnÃ­ analÃ½zy" atd.).

Struktura: MusÃ­ bÃ½t krÃ¡snÃ¡, rychlÃ¡ pro SEO a zamÄ›Å™enÃ¡ na konzumaci obsahu.

2. Admin strÃ¡nka (app/admin/dashboard/page.tsx) = "DÃ­lna" ğŸ› ï¸
Toto je vaÅ¡e pracovnÃ­ rozhranÃ­.

ÃšÄel: RychlÃ½ pÅ™ehled a sprÃ¡va pro ADMINa a KURATORy.

BudoucÃ­ vÃ½voj: Zde mÅ¯Å¾ete v budoucnu pÅ™idÃ¡vat vÄ›ci, kterÃ© nikdy nesmÃ­ vidÄ›t veÅ™ejnost:

Statistiky nÃ¡vÅ¡tÄ›vnosti.

Seznam poslednÃ­ch registrovanÃ½ch USERÅ¯.

TlaÄÃ­tko "SchvÃ¡lit Å¾Ã¡dost o KURATORa".

PÅ™ehled videÃ­, kterÃ¡ jeÅ¡tÄ› nemajÃ­ popisky (drafty).

Struktura: MusÃ­ bÃ½t hlavnÄ› funkÄnÃ­ a efektivnÃ­ pro sprÃ¡vu.

Jak vyÅ™eÅ¡it tu duplicitu? (ArchitektonickÃ© Å™eÅ¡enÃ­)
VaÅ¡e obava o "kompaktnost" je sprÃ¡vnÃ¡. Nechceme psÃ¡t stejnÃ½ kÃ³d dvakrÃ¡t.

Å˜eÅ¡enÃ­ je znovupouÅ¾itelnÃ¡ komponenta.

NevytvoÅ™Ã­me dvÄ› duplicitnÃ­ strÃ¡nky.

VytvoÅ™Ã­me jednu komponentu, napÅ™Ã­klad: components/VideoGrid.tsx.

Tato komponenta bude jen "hloupÃ¡" â€“ vezme si pole videÃ­ (videos: Video[]) a zobrazÃ­ je jako mÅ™Ã­Å¾ku.

Pak obÄ› naÅ¡e strÃ¡nky tuto komponentu pouÅ¾ijÃ­:

app/page.tsx (VeÅ™ejnÃ¡): NaÄte veÅ™ejnÃ¡ videa a pÅ™edÃ¡ je do <VideoGrid videos={publicVideos} />.

app/admin/dashboard/page.tsx (Admin): NaÄte vÅ¡echna videa (nebo drafty) a pÅ™edÃ¡ je do <VideoGrid videos={allVideos} />.

ZÃ¡vÄ›r:

DoporuÄuji ponechat obÄ› strÃ¡nky. VeÅ™ejnÃ¡ strÃ¡nka (/) bude "vÃ½loha", administrÃ¡torskÃ½ pÅ™ehled (/admin/dashboard) bude "dÃ­lna". TÃ­m, Å¾e budeme sdÃ­let komponenty (jako <VideoGrid>), udrÅ¾Ã­me kÃ³d kompaktnÃ­ a bez duplicit, ale zÃ¡roveÅˆ si dÃ¡me volnost do budoucna mÄ›nit jednu strÃ¡nku bez rozbitÃ­ tÃ© druhÃ©.





JÃ_PROMPT:
Ano pojdme tedy nynÃ­ vytvoÅ™it toto zÃ¡dÃ¡nÃ­ pro vytvoÅ™enÃ­ tÃ©to vÃ½kladnÃ­ skÅ™Ã­nÄ› aplikace s ohledem na znovupouÅ¾itelnost kodu a robustnÃ­ kontrolu prÃ¡v s ohledem na best practice ... dÃ­ky ;-) 


AI_RESPONZE:
RozumÃ­m. Na zÃ¡kladÄ› naÅ¡Ã­ diskuze o "vÃ½kladnÃ­ skÅ™Ã­ni", "dÃ­lnÄ›" a nutnosti znovupouÅ¾itelnosti kÃ³du, pÅ™ipravil jsem finÃ¡lnÃ­, robustnÃ­ zadÃ¡nÃ­ pro FÃ¡zi 8.

Toto zadÃ¡nÃ­ klade dÅ¯raz na "best practice" tÃ­m, Å¾e nÃ¡s donutÃ­ nejprve refaktorizovat stÃ¡vajÃ­cÃ­ kÃ³d (vytvoÅ™it sdÃ­lenou komponentu) a teprve potÃ© budovat novou funkci. TÃ­m zajistÃ­me kompaktnost a zabrÃ¡nÃ­me duplicitÄ›.

ğŸ“„ ZadÃ¡nÃ­ projektu: WebovÃ¡ aplikace Mediathek (FÃ¡ze 8 - VeÅ™ejnÃ¡ VÃ½loha)
Datum: 17. listopadu 2025 Verze: 8.0


Navazuje na: FÃ¡ze 7 (Implementace SbÃ­rek) 


1. NÃ¡zev projektu
Mediathek

2. ğŸ¯ CÃ­l FÃ¡ze
CÃ­lem tÃ©to fÃ¡ze je vytvoÅ™it veÅ™ejnou "vÃ½kladnÃ­ skÅ™Ã­Åˆ" aplikace. ZpÅ™Ã­stupnÃ­me obsah nÃ¡vÅ¡tÄ›vnÃ­kÅ¯m (VISITOR) a zÃ¡kladnÃ­m uÅ¾ivatelÅ¯m (USER) na novÃ© domovskÃ© strÃ¡nce (/). KlÃ­ÄovÃ½m prvkem je robustnÃ­ server-side filtrovÃ¡nÃ­ obsahu podle rolÃ­ a refaktorizace stÃ¡vajÃ­cÃ­ho kÃ³du pro maximÃ¡lnÃ­ znovupouÅ¾itelnost a "kompaktnost" aplikace.

3. Rozsah pro FÃ¡zi 8
Refaktorizace (NovÃ¡ komponenta): VytvoÅ™enÃ­ novÃ©, znovupouÅ¾itelnÃ© ("hloupÃ©") klientskÃ© komponenty components/VideoGrid.tsx, kterÃ¡ bude zodpovÄ›dnÃ¡ pouze za vizuÃ¡lnÃ­ zobrazenÃ­ mÅ™Ã­Å¾ky videÃ­.

Refaktorizace (Admin Dashboard): Ãšprava stÃ¡vajÃ­cÃ­ strÃ¡nky "PÅ™ehled obsahu" (app/admin/dashboard/page.tsx) tak, aby novÄ› pouÅ¾Ã­vala komponentu VideoGrid.tsx.

Architektura (NovÃ¡ strÃ¡nka): VytvoÅ™enÃ­ novÃ© domovskÃ© strÃ¡nky app/page.tsx jako React Server Component (RSC), kterÃ¡ bude slouÅ¾it jako veÅ™ejnÃ¡ "vÃ½loha".

Architektura (ZabezpeÄenÃ­): Ãšprava middleware.ts, aby byla domovskÃ¡ strÃ¡nka (/) veÅ™ejnÄ› pÅ™Ã­stupnÃ¡.

Backend (Data Fetching): Implementace server-side logiky oprÃ¡vnÄ›nÃ­ (RBAC) v app/page.tsx pro dynamickÃ© naÄÃ­tÃ¡nÃ­ videÃ­ dle role nÃ¡vÅ¡tÄ›vnÃ­ka.

4. ğŸ›ï¸ NÃ¡vrh Å˜eÅ¡enÃ­ a Architektura ("Best Practices")
Postupujeme podle principu "OddÄ›lenÃ­ odpovÄ›dnostÃ­" (Separation of Concerns).

4.1. ArchitektonickÃ© RozhodnutÃ­: "DÃ­lna" vs. "VÃ½loha"
Potvrzujeme strategii oddÄ›lenÃ­. ObÄ› strÃ¡nky si ponechÃ¡me:

app/page.tsx (VÃ½loha ğŸ›ï¸): Bude slouÅ¾it jako veÅ™ejnÃ¡ prezentace pro VISITORy a USERy. Je optimalizovÃ¡na pro konzumaci a SEO. Zobrazuje filtrovanÃ½ (veÅ™ejnÃ½) obsah.

app/admin/dashboard/page.tsx (DÃ­lna ğŸ› ï¸): ZÅ¯stÃ¡vÃ¡ internÃ­m nÃ¡strojem pro ADMINa a budoucÃ­ KURATORy. SlouÅ¾Ã­ pro rychlÃ½ pÅ™ehled, sprÃ¡vu a nÃ¡hled "draftÅ¯". Zobrazuje nefiltrovanÃ½ obsah.

4.2. ZnovupouÅ¾itelnost (KlÃ­ÄovÃ½ krok pro kompaktnost)
Abychom zabrÃ¡nili duplicitÄ› kÃ³du v "DÃ­lnÄ›" i "VÃ½loze", provedeme refaktorizaci jako prvnÃ­ krok:

VytvoÅ™enÃ­ components/VideoGrid.tsx:

Bude se jednat o klientskou komponentu ("use client").

Bude pÅ™ijÃ­mat pole videÃ­ jako prop: (props: { videos: Video[] }).

Bude obsahovat logiku pro zobrazenÃ­ mÅ™Ã­Å¾ky (karty, odkazy). VeÅ¡kerÃ¡ logika zobrazenÃ­ z admin/dashboard se pÅ™esune sem.

Bude "hloupÃ¡" â€“ nebude sama naÄÃ­tat data, pouze je zobrazÃ­.

Refaktorizace app/admin/dashboard/page.tsx:

StÃ¡vajÃ­cÃ­ logika prisma.video.findMany(...) zÅ¯stane.

CelÃ¡ return ÄÃ¡st (JSX) bude zjednoduÅ¡ena. MÃ­sto mapovÃ¡nÃ­ videÃ­ zde, pouze pÅ™edÃ¡ data novÃ© komponentÄ›: <VideoGrid videos={allVideos} />.

4.3. Implementace app/page.tsx (VeÅ™ejnÃ¡ VÃ½loha)
Teprve po refaktorizaci vytvoÅ™Ã­me novou veÅ™ejnou strÃ¡nku, kterÃ¡ bude takÃ© pouÅ¾Ã­vat sdÃ­lenou komponentu.

A. ZabezpeÄenÃ­ middleware.ts: MusÃ­me zajistit, Å¾e matcher v middleware.ts chrÃ¡nÃ­ pouze admin sekci a neblokuje koÅ™enovou strÃ¡nku /.

PÅ™Ã­klad sprÃ¡vnÃ©ho matcher: matcher: ['/admin/:path*']

B. Logika OprÃ¡vnÄ›nÃ­ (Server-Side Data Fetching): JÃ¡dro "best practice" â€“ veÅ¡kerÃ¡ logika oprÃ¡vnÄ›nÃ­ se odehraje na serveru.

TypeScript

// app/page.tsx
// (NovÃ¡ veÅ™ejnÃ¡ domovskÃ¡ strÃ¡nka)

import { getServerSession } from 'next-auth/next';
import { authOptions } from '@/app/api/auth/[...nextauth]/route';
import { PrismaClient, Prisma } from '@prisma/client';
// KROK 4.2: Importujeme naÅ¡i novou sdÃ­lenou komponentu
import { VideoGrid } from '@/components/VideoGrid'; 

const prisma = new PrismaClient();

// PovolÃ­me dynamickÃ© renderovÃ¡nÃ­, aby se vÅ¾dy naÄetla ÄerstvÃ¡ session
export const dynamic = 'force-dynamic'; 

export default async function HomePage() {
  const session = await getServerSession(authOptions);
  
  // 1. VÃ½chozÃ­ pravidlo (pro VISITORa a USERa)
  // ZobrazÃ­ pouze videa, kterÃ¡ jsou v ALESPOÅ‡ JEDNÃ‰ veÅ™ejnÃ© sbÃ­rce
  let whereClause: Prisma.VideoWhereInput = {
    collections: {
      some: {
        isPublic: true
      }
    }
  };

  // 2. Kontrola session a pÅ™epsÃ¡nÃ­ pravidla pro ADMINa
  // (ADMIN vidÃ­ i drafty a soukromÃ¡ videa)
  if (session && session.user.role === 'ADMIN') {
    // ADMIN vidÃ­ VÅ ECHNO
    whereClause = {}; 
  }

  // 3. TODO: PÅ™ipravit pro FÃ¡zi 9 (KURATOR)
  // if (session && session.user.role === 'KURATOR') {
  //   // KURATOR vidÃ­ VÅ ECHNY VEÅ˜EJNÃ‰ + VÅ ECHNY SVÃ‰ SOUKROMÃ‰
  //   whereClause = {
  //     OR: [
  //       { collections: { some: { isPublic: true } } },
  //       { authorId: session.user.id }
  //     ]
  //   };
  // }

  // 4. FinÃ¡lnÃ­ dotaz do DB
  const videos = await prisma.video.findMany({
    where: whereClause,
    include: {
      author: { select: { name: true } }, // PÅ™Ã­klad, pokud budeme chtÃ­t jmÃ©no autora
    },
    orderBy: { createdAt: 'desc' }
  });

  // 5. ZobrazenÃ­ pomocÃ­ znovupouÅ¾itelnÃ© komponenty
  return (
    <div className="container mx-auto p-4">
      <h1 className="text-3xl font-bold mb-6">VÃ­tejte v Mediathek</h1>
      {/* KROK 4.2: Zde pouÅ¾Ã­vÃ¡me sdÃ­lenou komponentu */}
      <VideoGrid videos={videos} />
    </div>
  );
}
5. ğŸš¦ FunkÄnÃ­ PoÅ¾adavky (FR)
FR1 (Refaktorizace): MusÃ­ bÃ½t vytvoÅ™ena sdÃ­lenÃ¡ komponenta components/VideoGrid.tsx.

FR2 (Admin Dashboard): StrÃ¡nka app/admin/dashboard/page.tsx musÃ­ bÃ½t upravena, aby pouÅ¾Ã­vala VideoGrid.tsx a jejÃ­ funkÄnost musÃ­ zÅ¯stat 100% zachovÃ¡na (musÃ­ stÃ¡le zobrazovat vÅ¡echna videa).

FR3 (VeÅ™ejnÃ¡ dostupnost): StrÃ¡nka / musÃ­ bÃ½t pÅ™Ã­stupnÃ¡ anonymnÃ­mu VISITORovi.

FR4 (VISITOR View): VISITOR (anonymnÃ­) na strÃ¡nce / vidÃ­ pouze videa, kterÃ¡ jsou pÅ™iÅ™azena alespoÅˆ k jednÃ© veÅ™ejnÃ© sbÃ­rce (isPublic: true).

FR5 (USER View): USER (pÅ™ihlÃ¡Å¡enÃ½) na strÃ¡nce / vidÃ­ totÃ©Å¾ co VISITOR.

FR6 (ADMIN View): ADMIN (pÅ™ihlÃ¡Å¡enÃ½) na strÃ¡nce / vidÃ­ vÅ¡echna videa (vÄetnÄ› draftÅ¯ a soukromÃ½ch videÃ­).

6. ğŸ”’ NefunkÄnÃ­ PoÅ¾adavky (NFR)
NFR1 (BezpeÄnost): VeÅ¡kerÃ¡ filtrace obsahu na zÃ¡kladÄ› oprÃ¡vnÄ›nÃ­ musÃ­ probÃ­hat vÃ½hradnÄ› na serveru v app/page.tsx. Klient nikdy nesmÃ­ obdrÅ¾et data, kterÃ¡ nemÃ¡ vidÄ›t.

NFR2 (Kompaktnost): KÃ³d pro zobrazenÃ­ mÅ™Ã­Å¾ky videÃ­ nesmÃ­ bÃ½t duplikovÃ¡n. MusÃ­ bÃ½t sdÃ­len mezi / a /admin/dashboard.

NFR3 (VÃ½kon): VeÅ™ejnÃ¡ strÃ¡nka / musÃ­ bÃ½t serverovÄ› renderovanÃ¡ (RSC) pro rychlÃ© naÄtenÃ­ a SEO.

7. ğŸ’» TechnologickÃ½ Stack a NÃ¡stroje
VyuÅ¾Ã­vÃ¡ se stÃ¡vajÃ­cÃ­ stack. Nejsou potÅ™eba Å¾Ã¡dnÃ© novÃ© knihovny.

8. âœ… AkceptaÄnÃ­ Kriteria (Definice "Hotovo")
Tato fÃ¡ze je dokonÄena, kdyÅ¾:

Test 1 (Refaktorizace): ADMIN navÅ¡tÃ­vÃ­ /admin/dashboard. StrÃ¡nka funguje a zobrazuje vÅ¡echna videa jako dÅ™Ã­ve, ale inspekce kÃ³du potvrdÃ­, Å¾e pouÅ¾Ã­vÃ¡ <VideoGrid>.

Test 2 (VISITOR): AnonymnÃ­ uÅ¾ivatel navÅ¡tÃ­vÃ­ /. StrÃ¡nka se naÄte a zobrazÃ­ pouze veÅ™ejnÃ¡ videa.

Test 3 (ADMIN): ADMIN navÅ¡tÃ­vÃ­ /. StrÃ¡nka se naÄte a zobrazÃ­ vÅ¡echna videa (veÅ™ejnÃ¡, soukromÃ¡ i drafty).

Test 4 (ScÃ©nÃ¡Å™: Draft):

ADMIN vytvoÅ™Ã­ video, ale nepÅ™iÅ™adÃ­ ho do Å¾Ã¡dnÃ© sbÃ­rky.

ADMIN toto video na / vidÃ­.

VISITOR (v anonymnÃ­m oknÄ›) toto video na / nevidÃ­.

Test 5 (ScÃ©nÃ¡Å™: SoukromÃ©):

ADMIN pÅ™iÅ™adÃ­ toto video pouze do soukromÃ© sbÃ­rky (isPublic: false).

ADMIN toto video na / vidÃ­.

VISITOR toto video na / nevidÃ­.

Test 6 (ScÃ©nÃ¡Å™: VeÅ™ejnÃ©):

ADMIN pÅ™iÅ™adÃ­ toto video do veÅ™ejnÃ© sbÃ­rky (isPublic: true).

VISITOR toto video na / vidÃ­.

9. ğŸš€ BudoucÃ­ Rozvoj (Mimo Rozsah TÃ©to FÃ¡ze)
FÃ¡ze 9: Implementace povyÅ¡ovÃ¡nÃ­ rolÃ­ USER na KURATOR a aktivace pÅ™ipravenÃ© // TODO: logiky v app/page.tsx.

FÃ¡ze 10: VytvoÅ™enÃ­ veÅ™ejnÃ© strÃ¡nky detailu videa (app/video/[id]/page.tsx) s vlastnÃ­ logikou oprÃ¡vnÄ›nÃ­.



id_chat: 
https://gemini.google.com/u/1/app/e98a834b6f5840c3


